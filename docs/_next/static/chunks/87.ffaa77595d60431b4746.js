(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[87],{7879:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WcSdk=t.WitnessScope=void 0;const r=n(8151),o=n(8394),s=["Any","Signature","Boolean","Integer","Hash160","Address","ScriptHash","Null","Hash256","ByteArray","PublicKey","String","ByteString","Array","Buffer","InteropInterface","Void"];var a;!function(e){e[e.None=0]="None",e[e.CalledByEntry=1]="CalledByEntry",e[e.CustomContracts=16]="CustomContracts",e[e.CustomGroups=32]="CustomGroups",e[e.Global=128]="Global"}(a=t.WitnessScope||(t.WitnessScope={}));class c{initClient(e,t){return i(this,void 0,void 0,(function*(){this.wcClient=yield c.initClient(e,t)}))}subscribeToEvents(e){c.subscribeToEvents(this.wcClient,e)}loadSession(){return i(this,void 0,void 0,(function*(){this.wcClient&&(this.session=(yield c.getSession(this.wcClient))||void 0)}))}connect(e){return i(this,void 0,void 0,(function*(){if(!this.wcClient)throw Error("The client was not initialized");this.session=yield c.connect(this.wcClient,e)}))}getAccountAddress(e){return this.session?c.getAccountAddress(this.session,e):null}get chainId(){return this.session?c.getChainId(this.session):null}get accountAddress(){return this.session?c.getAccountAddress(this.session):null}disconnect(){return i(this,void 0,void 0,(function*(){if(!this.wcClient)throw Error("The client was not initialized");if(!this.session)throw Error("No session open");yield c.disconnect(this.wcClient,this.session)}))}sendRequest(e){return i(this,void 0,void 0,(function*(){if(!this.wcClient)throw Error("The client was not initialized");if(!this.session)throw Error("No session open");if(!this.chainId)throw Error("No chainId informed");return yield c.sendRequest(this.wcClient,this.session,this.chainId,e)}))}invokeFunction(e,t){return i(this,void 0,void 0,(function*(){if(!this.wcClient)throw Error("The client was not initialized");if(!this.session)throw Error("No session open");if(!this.chainId)throw Error("No chainId informed");const n={signers:Array.isArray(t)?t:[t],invocations:Array.isArray(e)?e:[e]};return yield c.invokeFunction(this.wcClient,this.session,this.chainId,n)}))}testInvoke(e,t){return i(this,void 0,void 0,(function*(){if(!this.wcClient)throw Error("The client was not initialized");if(!this.session)throw Error("No session open");if(!this.chainId)throw Error("No chainId informed");const n={signers:Array.isArray(t)?t:[t],invocations:Array.isArray(e)?e:[e]};return yield c.testInvoke(this.wcClient,this.session,this.chainId,n)}))}signMessage(e){return i(this,void 0,void 0,(function*(){if(!this.wcClient)throw Error("The client was not initialized");if(!this.session)throw Error("No session open");if(!this.chainId)throw Error("No chainId informed");return yield c.signMessage(this.wcClient,this.session,this.chainId,e)}))}verifyMessage(e){return i(this,void 0,void 0,(function*(){if(!this.wcClient)throw Error("The client was not initialized");if(!this.session)throw Error("No session open");if(!this.chainId)throw Error("No chainId informed");return yield c.verifyMessage(this.wcClient,this.session,this.chainId,e)}))}static initClient(e,t){return i(this,void 0,void 0,(function*(){return yield r.default.init({logger:e,relayProvider:t})}))}static subscribeToEvents(e,t){if(!e)throw Error("The client was not initialized");e.on(r.CLIENT_EVENTS.pairing.proposal,(e=>i(this,void 0,void 0,(function*(){const{uri:n}=e.signal.params;t&&t.onProposal&&t.onProposal(n)})))),e.on(r.CLIENT_EVENTS.pairing.created,(()=>i(this,void 0,void 0,(function*(){t&&t.onCreated&&t.onCreated(e.pairing.topics)})))),e.on(r.CLIENT_EVENTS.session.deleted,(e=>i(this,void 0,void 0,(function*(){e.topic===(null===e||void 0===e?void 0:e.topic)&&t&&t.onDeleted&&t.onDeleted()}))))}static getSession(e){return i(this,void 0,void 0,(function*(){return(null===e||void 0===e?void 0:e.session.topics.length)?yield e.session.get(e.session.topics[0]):null}))}static getAccountInfo(e,t){const n=null!==t&&void 0!==t?t:0;return e.state.accounts.length<=n?null:e.state.accounts[n].split(":")}static getAccountAddress(e,t){const n=c.getAccountInfo(e,t);return n&&n[2]}static getChainId(e,t){const n=c.getAccountInfo(e,t);return n&&`${n[0]}:${n[1]}`}static connect(e,t){var n;return i(this,void 0,void 0,(function*(){return yield e.connect({metadata:t.appMetadata,pairing:t.topic?{topic:t.topic}:void 0,permissions:{blockchain:{chains:null!==(n=t.chains)&&void 0!==n?n:t.chainId?[t.chainId]:[]},jsonrpc:{methods:t.methods}}})}))}static disconnect(e,t){return i(this,void 0,void 0,(function*(){yield e.disconnect({topic:t.topic,reason:o.ERROR.USER_DISCONNECTED.format()})}))}static sendRequest(e,t,n,r){return i(this,void 0,void 0,(function*(){try{const i=yield e.request({topic:t.topic,chainId:n,request:r});return{method:r.method,result:i}}catch(i){return{method:r.method,result:{error:i}}}}))}static invokeFunction(e,t,n,r){return i(this,void 0,void 0,(function*(){return c.certifyInvocationPayload(r),c.sendRequest(e,t,n,{method:"invokeFunction",params:r})}))}static testInvoke(e,t,n,r){return i(this,void 0,void 0,(function*(){return c.certifyInvocationPayload(r),c.sendRequest(e,t,n,{method:"testInvoke",params:r})}))}static signMessage(e,t,n,r){return i(this,void 0,void 0,(function*(){return c.sendRequest(e,t,n,{method:"signMessage",params:r})}))}static verifyMessage(e,t,n,r){return i(this,void 0,void 0,(function*(){return c.sendRequest(e,t,n,{method:"verifyMessage",params:r})}))}static certifyInvocationPayload(e){return this.objectValidation(e,["signers","invocations"]),e.signers.forEach(((t,n)=>{if(!(t.scopes in a))throw new Error(`Invalid signature scopes: ${t.scopes}`);t.allowedContracts&&t.allowedContracts.length>0&&(e.signers[n].allowedContracts=t.allowedContracts.map((e=>{if(42!=e.length&&40!=e.length)throw new Error(`Invalid Script Hash (allowed contract): ${e}`);return 42==e.length?e:`0x${e}`})))})),e.invocations.forEach(((t,n)=>{if(this.objectValidation(t,["scriptHash","operation","args"]),42!=t.scriptHash.length&&40!=t.scriptHash.length)throw new Error(`Invalid Script Hash: ${t.scriptHash}`);e.invocations[n].scriptHash=42==t.scriptHash.length?t.scriptHash:`0x${t.scriptHash}`,t.args.forEach((e=>{if(this.objectValidation(e,["type","value"]),"string"!=typeof e.type||!s.includes(e.type))throw new Error(`Invalid argument type: ${e.type}`)}))})),!0}static objectValidation(e,t){const n=Object.keys(e);return t.forEach((e=>{if(n.indexOf(e)<0)throw new Error(`Missing required argument field ${e} in ${e}`)})),!0}}t.WcSdk=c},8099:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7117);function r(e,t,n){return void 0===t&&(t=new Uint8Array(2)),void 0===n&&(n=0),t[n+0]=e>>>8,t[n+1]=e>>>0,t}function o(e,t,n){return void 0===t&&(t=new Uint8Array(2)),void 0===n&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t}function s(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function a(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function c(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function u(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function d(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),t[n+0]=e>>>24,t[n+1]=e>>>16,t[n+2]=e>>>8,t[n+3]=e>>>0,t}function l(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),t[n+0]=e>>>0,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24,t}function f(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),d(e/4294967296>>>0,t,n),d(e>>>0,t,n+4),t}function E(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),l(e>>>0,t,n),l(e/4294967296>>>0,t,n+4),t}t.readInt16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16},t.readUint16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0},t.readInt16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16},t.readUint16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0},t.writeUint16BE=r,t.writeInt16BE=r,t.writeUint16LE=o,t.writeInt16LE=o,t.readInt32BE=s,t.readUint32BE=a,t.readInt32LE=c,t.readUint32LE=u,t.writeUint32BE=d,t.writeInt32BE=d,t.writeUint32LE=l,t.writeInt32LE=l,t.readInt64BE=function(e,t){void 0===t&&(t=0);var n=s(e,t),i=s(e,t+4);return 4294967296*n+i-4294967296*(i>>31)},t.readUint64BE=function(e,t){return void 0===t&&(t=0),4294967296*a(e,t)+a(e,t+4)},t.readInt64LE=function(e,t){void 0===t&&(t=0);var n=c(e,t);return 4294967296*c(e,t+4)+n-4294967296*(n>>31)},t.readUint64LE=function(e,t){void 0===t&&(t=0);var n=u(e,t);return 4294967296*u(e,t+4)+n},t.writeUint64BE=f,t.writeInt64BE=f,t.writeUint64LE=E,t.writeInt64LE=E,t.readUintBE=function(e,t,n){if(void 0===n&&(n=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,r=1,o=e/8+n-1;o>=n;o--)i+=t[o]*r,r*=256;return i},t.readUintLE=function(e,t,n){if(void 0===n&&(n=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-n)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,r=1,o=n;o<n+e/8;o++)i+=t[o]*r,r*=256;return i},t.writeUintBE=function(e,t,n,r){if(void 0===n&&(n=new Uint8Array(e/8)),void 0===r&&(r=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!i.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var o=1,s=e/8+r-1;s>=r;s--)n[s]=t/o&255,o*=256;return n},t.writeUintLE=function(e,t,n,r){if(void 0===n&&(n=new Uint8Array(e/8)),void 0===r&&(r=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!i.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var o=1,s=r;s<r+e/8;s++)n[s]=t/o&255,o*=256;return n},t.readFloat32BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t)},t.readFloat32LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},t.readFloat64BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t)},t.readFloat64LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},t.writeFloat32BE=function(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(n,e),t},t.writeFloat32LE=function(e,t,n){return void 0===t&&(t=new Uint8Array(4)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(n,e,!0),t},t.writeFloat64BE=function(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(n,e),t},t.writeFloat64LE=function(e,t,n){return void 0===t&&(t=new Uint8Array(8)),void 0===n&&(n=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(n,e,!0),t}},7117:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mul=Math.imul||function(e,t){var n=65535&e,i=65535&t;return n*i+((e>>>16&65535)*i+n*(t>>>16&65535)<<16>>>0)|0},t.add=function(e,t){return e+t|0},t.sub=function(e,t){return e-t|0},t.rotl=function(e,t){return e<<t|e>>>32-t},t.rotr=function(e,t){return e<<32-t|e>>>t},t.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(e){return t.isInteger(e)&&e>=-t.MAX_SAFE_INTEGER&&e<=t.MAX_SAFE_INTEGER}},1416:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6008),r=n(8099),o=n(7309);function s(e,n){return void 0===n&&(n=t.defaultRandomSource),n.randomBytes(e)}t.defaultRandomSource=new i.SystemRandomSource,t.randomBytes=s,t.randomUint32=function(e){void 0===e&&(e=t.defaultRandomSource);var n=s(4,e),i=r.readUint32LE(n);return o.wipe(n),i};var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(e,n,i){if(void 0===n&&(n=a),void 0===i&&(i=t.defaultRandomSource),n.length<2)throw new Error("randomString charset is too short");if(n.length>256)throw new Error("randomString charset is too long");for(var r="",c=n.length,u=256-256%c;e>0;){for(var d=s(Math.ceil(256*e/u),i),l=0;l<d.length&&e>0;l++){var f=d[l];f<u&&(r+=n.charAt(f%c),e--)}o.wipe(d)}return r}t.randomString=c,t.randomStringForEntropy=function(e,n,i){return void 0===n&&(n=a),void 0===i&&(i=t.defaultRandomSource),c(Math.ceil(e/(Math.log(n.length)/Math.LN2)),n,i)}},5455:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.isAvailable=!1,this.isInstantiated=!1;var e="undefined"!==typeof self?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return e.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var t=new Uint8Array(e),n=0;n<t.length;n+=65536)this._crypto.getRandomValues(t.subarray(n,n+Math.min(t.length-n,65536)));return t},e}();t.BrowserRandomSource=n},8871:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(7309),r=function(){function e(){this.isAvailable=!1,this.isInstantiated=!1;var e=n(5883);e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return e.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var n=new Uint8Array(e),r=0;r<n.length;r++)n[r]=t[r];return i.wipe(t),n},e}();t.NodeRandomSource=r},6008:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(5455),r=n(8871),o=function(){function e(){return this.isAvailable=!1,this.name="",this._source=new i.BrowserRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Browser")):(this._source=new r.NodeRandomSource,this._source.isAvailable?(this.isAvailable=!0,void(this.name="Node")):void 0)}return e.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},e}();t.SystemRandomSource=o},7309:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wipe=function(e){for(var t=0;t<e.length;t++)e[t]=0;return e}},7664:function(e,t,n){"use strict";var i=n(1416),r=n(7309);function o(e){var t=new Float64Array(16);if(e)for(var n=0;n<e.length;n++)t[n]=e[n];return t}t.kz=32,t.KS=32;var s=new Uint8Array(32);s[0]=9;var a=o([56129,1]);function c(e){for(var t=1,n=0;n<16;n++){var i=e[n]+t+65535;t=Math.floor(i/65536),e[n]=i-65536*t}e[0]+=t-1+37*(t-1)}function u(e,t,n){for(var i=~(n-1),r=0;r<16;r++){var o=i&(e[r]^t[r]);e[r]^=o,t[r]^=o}}function d(e,t,n){for(var i=0;i<16;i++)e[i]=t[i]+n[i]}function l(e,t,n){for(var i=0;i<16;i++)e[i]=t[i]-n[i]}function f(e,t,n){var i,r,o=0,s=0,a=0,c=0,u=0,d=0,l=0,f=0,E=0,h=0,p=0,R=0,_=0,g=0,y=0,T=0,O=0,v=0,S=0,m=0,N=0,I=0,P=0,A=0,C=0,b=0,D=0,U=0,w=0,L=0,M=0,H=n[0],q=n[1],x=n[2],Y=n[3],G=n[4],V=n[5],j=n[6],K=n[7],J=n[8],$=n[9],k=n[10],B=n[11],F=n[12],W=n[13],Q=n[14],Z=n[15];o+=(i=t[0])*H,s+=i*q,a+=i*x,c+=i*Y,u+=i*G,d+=i*V,l+=i*j,f+=i*K,E+=i*J,h+=i*$,p+=i*k,R+=i*B,_+=i*F,g+=i*W,y+=i*Q,T+=i*Z,s+=(i=t[1])*H,a+=i*q,c+=i*x,u+=i*Y,d+=i*G,l+=i*V,f+=i*j,E+=i*K,h+=i*J,p+=i*$,R+=i*k,_+=i*B,g+=i*F,y+=i*W,T+=i*Q,O+=i*Z,a+=(i=t[2])*H,c+=i*q,u+=i*x,d+=i*Y,l+=i*G,f+=i*V,E+=i*j,h+=i*K,p+=i*J,R+=i*$,_+=i*k,g+=i*B,y+=i*F,T+=i*W,O+=i*Q,v+=i*Z,c+=(i=t[3])*H,u+=i*q,d+=i*x,l+=i*Y,f+=i*G,E+=i*V,h+=i*j,p+=i*K,R+=i*J,_+=i*$,g+=i*k,y+=i*B,T+=i*F,O+=i*W,v+=i*Q,S+=i*Z,u+=(i=t[4])*H,d+=i*q,l+=i*x,f+=i*Y,E+=i*G,h+=i*V,p+=i*j,R+=i*K,_+=i*J,g+=i*$,y+=i*k,T+=i*B,O+=i*F,v+=i*W,S+=i*Q,m+=i*Z,d+=(i=t[5])*H,l+=i*q,f+=i*x,E+=i*Y,h+=i*G,p+=i*V,R+=i*j,_+=i*K,g+=i*J,y+=i*$,T+=i*k,O+=i*B,v+=i*F,S+=i*W,m+=i*Q,N+=i*Z,l+=(i=t[6])*H,f+=i*q,E+=i*x,h+=i*Y,p+=i*G,R+=i*V,_+=i*j,g+=i*K,y+=i*J,T+=i*$,O+=i*k,v+=i*B,S+=i*F,m+=i*W,N+=i*Q,I+=i*Z,f+=(i=t[7])*H,E+=i*q,h+=i*x,p+=i*Y,R+=i*G,_+=i*V,g+=i*j,y+=i*K,T+=i*J,O+=i*$,v+=i*k,S+=i*B,m+=i*F,N+=i*W,I+=i*Q,P+=i*Z,E+=(i=t[8])*H,h+=i*q,p+=i*x,R+=i*Y,_+=i*G,g+=i*V,y+=i*j,T+=i*K,O+=i*J,v+=i*$,S+=i*k,m+=i*B,N+=i*F,I+=i*W,P+=i*Q,A+=i*Z,h+=(i=t[9])*H,p+=i*q,R+=i*x,_+=i*Y,g+=i*G,y+=i*V,T+=i*j,O+=i*K,v+=i*J,S+=i*$,m+=i*k,N+=i*B,I+=i*F,P+=i*W,A+=i*Q,C+=i*Z,p+=(i=t[10])*H,R+=i*q,_+=i*x,g+=i*Y,y+=i*G,T+=i*V,O+=i*j,v+=i*K,S+=i*J,m+=i*$,N+=i*k,I+=i*B,P+=i*F,A+=i*W,C+=i*Q,b+=i*Z,R+=(i=t[11])*H,_+=i*q,g+=i*x,y+=i*Y,T+=i*G,O+=i*V,v+=i*j,S+=i*K,m+=i*J,N+=i*$,I+=i*k,P+=i*B,A+=i*F,C+=i*W,b+=i*Q,D+=i*Z,_+=(i=t[12])*H,g+=i*q,y+=i*x,T+=i*Y,O+=i*G,v+=i*V,S+=i*j,m+=i*K,N+=i*J,I+=i*$,P+=i*k,A+=i*B,C+=i*F,b+=i*W,D+=i*Q,U+=i*Z,g+=(i=t[13])*H,y+=i*q,T+=i*x,O+=i*Y,v+=i*G,S+=i*V,m+=i*j,N+=i*K,I+=i*J,P+=i*$,A+=i*k,C+=i*B,b+=i*F,D+=i*W,U+=i*Q,w+=i*Z,y+=(i=t[14])*H,T+=i*q,O+=i*x,v+=i*Y,S+=i*G,m+=i*V,N+=i*j,I+=i*K,P+=i*J,A+=i*$,C+=i*k,b+=i*B,D+=i*F,U+=i*W,w+=i*Q,L+=i*Z,T+=(i=t[15])*H,s+=38*(v+=i*x),a+=38*(S+=i*Y),c+=38*(m+=i*G),u+=38*(N+=i*V),d+=38*(I+=i*j),l+=38*(P+=i*K),f+=38*(A+=i*J),E+=38*(C+=i*$),h+=38*(b+=i*k),p+=38*(D+=i*B),R+=38*(U+=i*F),_+=38*(w+=i*W),g+=38*(L+=i*Q),y+=38*(M+=i*Z),o=(i=(o+=38*(O+=i*q))+(r=1)+65535)-65536*(r=Math.floor(i/65536)),s=(i=s+r+65535)-65536*(r=Math.floor(i/65536)),a=(i=a+r+65535)-65536*(r=Math.floor(i/65536)),c=(i=c+r+65535)-65536*(r=Math.floor(i/65536)),u=(i=u+r+65535)-65536*(r=Math.floor(i/65536)),d=(i=d+r+65535)-65536*(r=Math.floor(i/65536)),l=(i=l+r+65535)-65536*(r=Math.floor(i/65536)),f=(i=f+r+65535)-65536*(r=Math.floor(i/65536)),E=(i=E+r+65535)-65536*(r=Math.floor(i/65536)),h=(i=h+r+65535)-65536*(r=Math.floor(i/65536)),p=(i=p+r+65535)-65536*(r=Math.floor(i/65536)),R=(i=R+r+65535)-65536*(r=Math.floor(i/65536)),_=(i=_+r+65535)-65536*(r=Math.floor(i/65536)),g=(i=g+r+65535)-65536*(r=Math.floor(i/65536)),y=(i=y+r+65535)-65536*(r=Math.floor(i/65536)),T=(i=T+r+65535)-65536*(r=Math.floor(i/65536)),o=(i=(o+=r-1+37*(r-1))+(r=1)+65535)-65536*(r=Math.floor(i/65536)),s=(i=s+r+65535)-65536*(r=Math.floor(i/65536)),a=(i=a+r+65535)-65536*(r=Math.floor(i/65536)),c=(i=c+r+65535)-65536*(r=Math.floor(i/65536)),u=(i=u+r+65535)-65536*(r=Math.floor(i/65536)),d=(i=d+r+65535)-65536*(r=Math.floor(i/65536)),l=(i=l+r+65535)-65536*(r=Math.floor(i/65536)),f=(i=f+r+65535)-65536*(r=Math.floor(i/65536)),E=(i=E+r+65535)-65536*(r=Math.floor(i/65536)),h=(i=h+r+65535)-65536*(r=Math.floor(i/65536)),p=(i=p+r+65535)-65536*(r=Math.floor(i/65536)),R=(i=R+r+65535)-65536*(r=Math.floor(i/65536)),_=(i=_+r+65535)-65536*(r=Math.floor(i/65536)),g=(i=g+r+65535)-65536*(r=Math.floor(i/65536)),y=(i=y+r+65535)-65536*(r=Math.floor(i/65536)),T=(i=T+r+65535)-65536*(r=Math.floor(i/65536)),o+=r-1+37*(r-1),e[0]=o,e[1]=s,e[2]=a,e[3]=c,e[4]=u,e[5]=d,e[6]=l,e[7]=f,e[8]=E,e[9]=h,e[10]=p,e[11]=R,e[12]=_,e[13]=g,e[14]=y,e[15]=T}function E(e,t){f(e,t,t)}function h(e,t){for(var n=new Uint8Array(32),i=new Float64Array(80),r=o(),s=o(),h=o(),p=o(),R=o(),_=o(),g=0;g<31;g++)n[g]=e[g];n[31]=127&e[31]|64,n[0]&=248,function(e,t){for(var n=0;n<16;n++)e[n]=t[2*n]+(t[2*n+1]<<8);e[15]&=32767}(i,t);for(g=0;g<16;g++)s[g]=i[g];r[0]=p[0]=1;for(g=254;g>=0;--g){var y=n[g>>>3]>>>(7&g)&1;u(r,s,y),u(h,p,y),d(R,r,h),l(r,r,h),d(h,s,p),l(s,s,p),E(p,R),E(_,r),f(r,h,r),f(h,s,R),d(R,r,h),l(r,r,h),E(s,r),l(h,p,_),f(r,h,a),d(r,r,p),f(h,h,r),f(r,p,_),f(p,s,i),E(s,R),u(r,s,y),u(h,p,y)}for(g=0;g<16;g++)i[g+16]=r[g],i[g+32]=h[g],i[g+48]=s[g],i[g+64]=p[g];var T=i.subarray(32),O=i.subarray(16);!function(e,t){for(var n=o(),i=0;i<16;i++)n[i]=t[i];for(i=253;i>=0;i--)E(n,n),2!==i&&4!==i&&f(n,n,t);for(i=0;i<16;i++)e[i]=n[i]}(T,T),f(O,O,T);var v=new Uint8Array(32);return function(e,t){for(var n=o(),i=o(),r=0;r<16;r++)i[r]=t[r];c(i),c(i),c(i);for(var s=0;s<2;s++){for(n[0]=i[0]-65517,r=1;r<15;r++)n[r]=i[r]-65535-(n[r-1]>>16&1),n[r-1]&=65535;n[15]=i[15]-32767-(n[14]>>16&1);var a=n[15]>>16&1;n[14]&=65535,u(i,n,1-a)}for(r=0;r<16;r++)e[2*r]=255&i[r],e[2*r+1]=i[r]>>8}(v,O),v}function p(e){return h(e,s)}function R(e){if(e.length!==t.KS)throw new Error("x25519: seed must be "+t.KS+" bytes");var n=new Uint8Array(e);return{publicKey:p(n),secretKey:n}}t.Au=function(e){var t=i.randomBytes(32,e),n=R(t);return r.wipe(t),n},t.gi=function(e,n,i){if(void 0===i&&(i=!1),e.length!==t.kz)throw new Error("X25519: incorrect secret key length");if(n.length!==t.kz)throw new Error("X25519: incorrect public key length");var r=h(e,n);if(i){for(var o=0,s=0;s<r.length;s++)o|=r[s];if(0===o)throw new Error("X25519: invalid shared key")}return r}},6613:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;const i=n(655),r=n(7187),o=i.__importDefault(n(5571)),s=i.__importDefault(n(3534)),a=n(3609),c=n(5094),u=n(9107),d=n(768),l=n(7702),f=n(9384);class E extends a.IClient{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new r.EventEmitter,this.context=l.CLIENT_CONTEXT;const t="undefined"!==typeof(null===e||void 0===e?void 0:e.logger)&&"string"!==typeof(null===e||void 0===e?void 0:e.logger)?e.logger:o.default(u.getDefaultLoggerOptions({level:(null===e||void 0===e?void 0:e.logger)||"error"}));this.context=(null===e||void 0===e?void 0:e.name)||this.context,this.controller=(null===e||void 0===e?void 0:e.controller)||!1,this.metadata=(null===e||void 0===e?void 0:e.metadata)||c.getAppMetadata();const n=(null===e||void 0===e?void 0:e.storage)||new s.default(Object.assign(Object.assign({},l.CLIENT_STORAGE_OPTIONS),null===e||void 0===e?void 0:e.storageOptions));this.logger=u.generateChildLogger(t,this.context),this.crypto=new f.Crypto(this,(null===e||void 0===e?void 0:e.keychain)||new f.KeyChain(this,n)),this.relayer=new d.Relayer(this,this.logger,null===e||void 0===e?void 0:e.relayProvider),this.storage=n,this.pairing=new d.Pairing(this,this.logger),this.session=new d.Session(this,this.logger)}static init(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=new E(e);return yield t.initialize(),t}))}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}connect(e){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.debug("Connecting Application"),this.logger.trace({type:"method",method:"connect",params:e});try{void 0===typeof e.pairing&&this.logger.info("Connecing with existing pairing");const t="undefined"===typeof e.pairing?yield this.pairing.create():yield this.pairing.get(e.pairing.topic);this.logger.trace({type:"method",method:"connect",pairing:t});const n=e.metadata||this.metadata;if("undefined"===typeof n){const e=c.ERROR.MISSING_OR_INVALID.format({name:"app metadata"});throw this.logger.error(e.message),new Error(e.message)}const i=yield this.session.create({signal:{method:l.SESSION_SIGNAL_METHOD_PAIRING,params:{topic:t.topic}},relay:e.relay||{protocol:l.RELAYER_DEFAULT_PROTOCOL},metadata:n,permissions:Object.assign(Object.assign({},e.permissions),{notifications:l.SESSION_EMPTY_PERMISSIONS.notifications})});return this.logger.debug("Application Connection Successful"),this.logger.trace({type:"method",method:"connect",session:i}),i}catch(t){throw this.logger.debug("Application Connection Failure"),this.logger.error(t),t}}))}pair(e){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.debug("Pairing"),this.logger.trace({type:"method",method:"pair",params:e});const t=function(e){const t=c.parseUri(e);return{topic:t.topic,relay:t.relay,proposer:{publicKey:t.publicKey,controller:t.controller},signal:{method:l.PAIRING_SIGNAL_METHOD_URI,params:{uri:e}},permissions:{jsonrpc:{methods:[l.SESSION_JSONRPC.propose]},notifications:{types:[]}},ttl:l.PAIRING_DEFAULT_TTL}}(e.uri),n=t.proposer.controller!==this.controller,i=n?void 0:c.ERROR.UNAUTHORIZED_MATCHING_CONTROLLER.format({controller:this.controller}),r=yield this.pairing.respond({approved:n,proposal:t,reason:i});if(!c.isPairingResponded(r)){const e=c.ERROR.NO_MATCHING_RESPONSE.format({context:"pairing"});throw this.logger.error(e.message),new Error(e.message)}if(c.isPairingFailed(r.outcome))throw this.logger.debug("Pairing Failure"),this.logger.trace({type:"method",method:"pair",outcome:r.outcome}),new Error(r.outcome.reason.message);return this.logger.debug("Pairing Success"),this.logger.trace({type:"method",method:"pair",pending:r}),r.outcome.topic}))}approve(e){return i.__awaiter(this,void 0,void 0,(function*(){if(this.logger.debug("Approving Session Proposal"),this.logger.trace({type:"method",method:"approve",params:e}),"undefined"===typeof e.response){const e=c.ERROR.MISSING_RESPONSE.format({context:"session"});throw this.logger.error(e.message),new Error(e.message)}const t=e.response.state||l.SESSION_EMPTY_STATE,n=e.response.metadata||this.metadata;if("undefined"===typeof n){const e=c.ERROR.MISSING_OR_INVALID.format({name:"app metadata"});throw this.logger.error(e.message),new Error(e.message)}const i=e.proposal.proposer.controller!==this.controller,r=i?void 0:c.ERROR.UNAUTHORIZED_MATCHING_CONTROLLER.format({controller:this.controller}),o=yield this.session.respond({approved:i,proposal:e.proposal,response:{state:t,metadata:n},reason:r});if(!c.isSessionResponded(o)){const e=c.ERROR.NO_MATCHING_RESPONSE.format({context:"session"});throw this.logger.error(e.message),new Error(e.message)}if(c.isSessionFailed(o.outcome))throw this.logger.debug("Session Proposal Approval Failure"),this.logger.trace({type:"method",method:"approve",outcome:o.outcome}),new Error(o.outcome.reason.message);return this.logger.debug("Session Proposal Approval Success"),this.logger.trace({type:"method",method:"approve",pending:o}),this.session.get(o.outcome.topic)}))}reject(e){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.debug("Rejecting Session Proposal"),this.logger.trace({type:"method",method:"reject",params:e});const t=yield this.session.respond({approved:!1,proposal:e.proposal,response:l.SESSION_EMPTY_RESPONSE,reason:e.reason});this.logger.debug("Session Proposal Response Success"),this.logger.trace({type:"method",method:"reject",pending:t})}))}upgrade(e){return i.__awaiter(this,void 0,void 0,(function*(){yield this.session.upgrade(e)}))}update(e){return i.__awaiter(this,void 0,void 0,(function*(){yield this.session.update(e)}))}request(e){return i.__awaiter(this,void 0,void 0,(function*(){return this.session.request(e)}))}respond(e){return i.__awaiter(this,void 0,void 0,(function*(){yield this.session.send(e.topic,e.response)}))}notify(e){return i.__awaiter(this,void 0,void 0,(function*(){yield this.session.notify(e)}))}disconnect(e){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.debug("Disconnecting Application"),this.logger.trace({type:"method",method:"disconnect",params:e}),yield this.session.delete(e)}))}onPairingRequest(e){return i.__awaiter(this,void 0,void 0,(function*(){if(e.method===l.SESSION_JSONRPC.propose){const t=e.params;if(t.proposer.controller===this.controller){const e=c.ERROR.UNAUTHORIZED_MATCHING_CONTROLLER.format({controller:this.controller});return void(yield this.session.respond({approved:!1,proposal:t,response:l.SESSION_EMPTY_RESPONSE,reason:e}))}const n=l.CLIENT_EVENTS.session.proposal;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.events.emit(n,t)}}))}onPairingSettled(e){return i.__awaiter(this,void 0,void 0,(function*(){e.permissions.controller.publicKey===e.self.publicKey&&"undefined"===typeof e.state.metadata&&(yield this.pairing.update({topic:e.topic,state:{metadata:this.metadata}}))}))}initialize(){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.trace("Initialized");try{yield this.crypto.init(),yield this.relayer.init(),yield this.pairing.init(),yield this.session.init(),this.setBeatInterval(),this.registerEventListeners(),this.logger.info("Client Initilization Success")}catch(e){throw this.logger.info("Client Initilization Failure"),this.logger.error(e),e}}))}setBeatInterval(){setInterval((()=>this.events.emit(l.CLIENT_EVENTS.beat)),l.CLIENT_BEAT_INTERVAL)}registerEventListeners(){this.pairing.on(l.PAIRING_EVENTS.proposed,(e=>{const t=l.CLIENT_EVENTS.pairing.proposal;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e.proposal}),this.events.emit(t,e.proposal)})),this.pairing.on(l.PAIRING_EVENTS.settled,(e=>{const t=l.CLIENT_EVENTS.pairing.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.events.emit(t,e),this.onPairingSettled(e)})),this.pairing.on(l.PAIRING_EVENTS.updated,((e,t)=>{const n=l.CLIENT_EVENTS.pairing.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e,update:t}),this.events.emit(n,e,t)})),this.pairing.on(l.PAIRING_EVENTS.deleted,((e,t)=>{const n=l.CLIENT_EVENTS.pairing.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e,reason:t}),this.events.emit(n,e,t)})),this.pairing.on(l.PAIRING_EVENTS.request,(e=>{this.onPairingRequest(e.request)})),this.session.on(l.SESSION_EVENTS.proposed,(e=>{const t=l.CLIENT_EVENTS.session.proposal;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e.proposal}),this.events.emit(t,e.proposal)})),this.session.on(l.SESSION_EVENTS.settled,(e=>{const t=l.CLIENT_EVENTS.session.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.events.emit(t,e)})),this.session.on(l.SESSION_EVENTS.updated,((e,t)=>{const n=l.CLIENT_EVENTS.session.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e,update:t}),this.events.emit(n,e,t)})),this.session.on(l.SESSION_EVENTS.deleted,((e,t)=>{const n=l.CLIENT_EVENTS.session.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e,reason:t}),this.events.emit(n,e,t)})),this.session.on(l.SESSION_EVENTS.request,(e=>{const t=l.CLIENT_EVENTS.session.request;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.events.emit(t,e)})),this.session.on(l.SESSION_EVENTS.response,(e=>{const t=l.CLIENT_EVENTS.session.response;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.events.emit(t,e)})),this.session.on(l.SESSION_EVENTS.notification,(e=>{const t=l.CLIENT_EVENTS.session.notification;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.events.emit(t,e)}))}}t.Client=E},9569:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLIENT_STORAGE_OPTIONS=t.CLIENT_EVENTS=t.CLIENT_BEAT_INTERVAL=t.CLIENT_CONTEXT=void 0;const i=n(2697);t.CLIENT_CONTEXT="client",t.CLIENT_BEAT_INTERVAL=1e3*i.FIVE_SECONDS,t.CLIENT_EVENTS={beat:"client_beat",pairing:{proposal:"pairing_proposal",updated:"pairing_updated",created:"pairing_created",deleted:"pairing_deleted"},session:{proposal:"session_proposal",updated:"session_updated",created:"session_created",deleted:"session_deleted",notification:"session_notification",request:"session_request",response:"session_response"}},t.CLIENT_STORAGE_OPTIONS={database:":memory:"}},3942:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEYCHAIN_CONTEXT=t.CRYPTO_CONTEXT=void 0,t.CRYPTO_CONTEXT="crypto",t.KEYCHAIN_CONTEXT="keychain"},9162:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HISTORY_CONTEXT=t.HISTORY_EVENTS=void 0,t.HISTORY_EVENTS={created:"history_created",updated:"history_updated",deleted:"history_deleted",enabled:"history_enabled",disabled:"history_disabled",sync:"history_sync"},t.HISTORY_CONTEXT="history"},7702:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(655);i.__exportStar(n(9569),t),i.__exportStar(n(3942),t),i.__exportStar(n(9162),t),i.__exportStar(n(2062),t),i.__exportStar(n(8007),t),i.__exportStar(n(1958),t),i.__exportStar(n(8949),t),i.__exportStar(n(2697),t)},2062:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PAIRING_EVENTS=t.PAIRING_STATUS=t.PAIRING_SIGNAL_METHOD_URI=t.PAIRING_DEFAULT_TTL=t.PAIRING_CONTEXT=t.PAIRING_JSONRPC=void 0;const i=n(2697);t.PAIRING_JSONRPC={propose:"wc_pairingPropose",approve:"wc_pairingApprove",reject:"wc_pairingReject",update:"wc_pairingUpdate",upgrade:"wc_pairingUpgrade",delete:"wc_pairingDelete",payload:"wc_pairingPayload",ping:"wc_pairingPing",notification:"wc_pairingNotification"},t.PAIRING_CONTEXT="pairing",t.PAIRING_DEFAULT_TTL=i.THIRTY_DAYS,t.PAIRING_SIGNAL_METHOD_URI="uri",t.PAIRING_STATUS={proposed:"proposed",responded:"responded",pending:"pending",settled:"settled"},t.PAIRING_EVENTS={proposed:"pairing_proposed",responded:"pairing_responded",settled:"pairing_settled",updated:"pairing_updated",deleted:"pairing_deleted",request:"pairing_request",response:"pairing_response",enabled:"pairing_enabled",disabled:"pairing_disabled",sync:"pairing_sync",notification:"pairing_notification"}},8007:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RELAYER_EVENTS=t.RELAYER_CONTEXT=t.RELAYER_DEFAULT_RPC_URL=t.RELAYER_DEFAULT_PROTOCOL=t.RELAYER_DEFAULT_PUBLISH_TTL=void 0;const i=n(2697);t.RELAYER_DEFAULT_PUBLISH_TTL=i.SIX_HOURS,t.RELAYER_DEFAULT_PROTOCOL="waku",t.RELAYER_DEFAULT_RPC_URL="wss://relay.walletconnect.org",t.RELAYER_CONTEXT="relayer",t.RELAYER_EVENTS={connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error"}},1958:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SESSION_EMPTY_RESPONSE=t.SESSION_EMPTY_METADATA=t.SESSION_EMPTY_STATE=t.SESSION_EMPTY_PERMISSIONS=t.SESSION_EVENTS=t.SESSION_STATUS=t.SESSION_SIGNAL_METHOD_PAIRING=t.SESSION_DEFAULT_TTL=t.SESSION_CONTEXT=t.SESSION_JSONRPC=void 0;const i=n(2697);t.SESSION_JSONRPC={propose:"wc_sessionPropose",approve:"wc_sessionApprove",reject:"wc_sessionReject",update:"wc_sessionUpdate",upgrade:"wc_sessionUpgrade",delete:"wc_sessionDelete",payload:"wc_sessionPayload",ping:"wc_sessionPing",notification:"wc_sessionNotification"},t.SESSION_CONTEXT="session",t.SESSION_DEFAULT_TTL=i.SEVEN_DAYS,t.SESSION_SIGNAL_METHOD_PAIRING="pairing",t.SESSION_STATUS={proposed:"proposed",responded:"responded",pending:"pending",settled:"settled"},t.SESSION_EVENTS={proposed:"session_proposed",responded:"session_responded",settled:"session_settled",updated:"session_updated",deleted:"session_deleted",request:"session_request",response:"session_response",enabled:"session_enabled",disabled:"session_disabled",sync:"session_sync",notification:"session_notification"},t.SESSION_EMPTY_PERMISSIONS={jsonrpc:{methods:[]},blockchain:{chains:[]},notifications:{types:[]}},t.SESSION_EMPTY_STATE={accounts:[]},t.SESSION_EMPTY_METADATA={name:"",description:"",url:"",icons:[]},t.SESSION_EMPTY_RESPONSE={metadata:t.SESSION_EMPTY_METADATA,state:t.SESSION_EMPTY_STATE}},8949:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SUBSCRIPTION_DEFAULT_TTL=t.SUBSCRIPTION_EVENTS=void 0;const i=n(2697);t.SUBSCRIPTION_EVENTS={payload:"subscription_payload",created:"subscription_created",updated:"subscription_updated",deleted:"subscription_deleted",enabled:"subscription_enabled",disabled:"subscription_disabled",sync:"subscription_sync"},t.SUBSCRIPTION_DEFAULT_TTL=i.THIRTY_DAYS},2697:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FIVE_SECONDS=t.TEN_SECONDS=t.THIRTY_SECONDS=t.FIVE_MINUTES=t.SIX_HOURS=t.ONE_DAY=t.SEVEN_DAYS=t.THREE_WEEKS=t.THIRTY_DAYS=void 0,t.THIRTY_DAYS=2592e3,t.THREE_WEEKS=1814400,t.SEVEN_DAYS=604800,t.ONE_DAY=86400,t.SIX_HOURS=21600,t.FIVE_MINUTES=300,t.THIRTY_SECONDS=30,t.TEN_SECONDS=10,t.FIVE_SECONDS=5},9384:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Crypto=t.KeyChain=void 0;const i=n(655),r=i.__importStar(n(3087)),o=n(5094),s=n(7702);t.KeyChain=class{constructor(e,t){this.client=e,this.storage=t,this.keychain=new Map,this.context=s.KEYCHAIN_CONTEXT,this.client=e,this.storage=t}init(){return i.__awaiter(this,void 0,void 0,(function*(){yield this.restore()}))}has(e,t){return i.__awaiter(this,void 0,void 0,(function*(){return this.keychain.has(e)}))}set(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){this.keychain.set(e,t),yield this.persist()}))}get(e,t){return i.__awaiter(this,void 0,void 0,(function*(){const t=this.keychain.get(e);if("undefined"===typeof t)throw new Error(o.ERROR.NO_MATCHING_KEY.format({tag:e}).message);return t}))}del(e,t){return i.__awaiter(this,void 0,void 0,(function*(){this.keychain.delete(e),yield this.persist()}))}getStorageKey(){return`${`${this.client.protocol}@${this.client.version}:${this.client.context}`}//${this.context}`}restore(){return i.__awaiter(this,void 0,void 0,(function*(){const e=yield this.storage.getItem(this.getStorageKey());"undefined"!==typeof e&&(this.keychain=o.objToMap(e))}))}persist(){return i.__awaiter(this,void 0,void 0,(function*(){yield this.storage.setItem(this.getStorageKey(),o.mapToObj(this.keychain))}))}};t.Crypto=class{constructor(e,t){this.client=e,this.keychain=t,this.context=s.CRYPTO_CONTEXT,this.client=e,this.keychain=t}init(){return i.__awaiter(this,void 0,void 0,(function*(){yield this.keychain.init()}))}hasKeys(e){return i.__awaiter(this,void 0,void 0,(function*(){return this.keychain.has(e)}))}generateKeyPair(){return i.__awaiter(this,void 0,void 0,(function*(){const e=o.generateKeyPair();return this.setKeyPair(e)}))}generateSharedKey(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){const i=yield this.getKeyPair(e.publicKey),r=o.deriveSharedKey(i.privateKey,t.publicKey);return this.setEncryptionKeys({sharedKey:r,publicKey:i.publicKey},n)}))}encrypt(e,t){return i.__awaiter(this,void 0,void 0,(function*(){const{sharedKey:n,publicKey:i}=yield this.getEncryptionKeys(e);return yield o.encrypt({message:t,sharedKey:n,publicKey:i})}))}decrypt(e,t){return i.__awaiter(this,void 0,void 0,(function*(){const{sharedKey:n}=yield this.getEncryptionKeys(e);return yield o.decrypt({encrypted:t,sharedKey:n})}))}concatKeys(e,t){return r.arrayToHex(r.concatArrays(r.hexToArray(e),r.hexToArray(t)))}splitKeys(e){const t=r.hexToArray(e);return[r.arrayToHex(t.slice(0,32)),r.arrayToHex(t.slice(32,64))]}setKeyPair(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=this.concatKeys(e.publicKey,e.privateKey);return yield this.keychain.set(e.publicKey,t),e.publicKey}))}getKeyPair(e){return i.__awaiter(this,void 0,void 0,(function*(){const[t,n]=this.splitKeys(yield this.keychain.get(e));return{publicKey:e,privateKey:n}}))}setEncryptionKeys(e,t){return i.__awaiter(this,void 0,void 0,(function*(){const n=t||(yield o.sha256(e.sharedKey)),i=this.concatKeys(e.sharedKey,e.publicKey);return yield this.keychain.set(n,i),n}))}getEncryptionKeys(e){return i.__awaiter(this,void 0,void 0,(function*(){const[t,n]=this.splitKeys(yield this.keychain.get(e));return{sharedKey:t,publicKey:n}}))}}},6327:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Engine=void 0;const i=n(655),r=n(3609),o=n(5094),s=n(6186),a=n(7702);class c extends r.IEngine{constructor(e){super(e),this.sequence=e,this.registerEventListeners()}find(e){return i.__awaiter(this,void 0,void 0,(function*(){return this.sequence.values.filter((t=>{var n,i,r,s,a,c;let u=!1;return(null===(n=t.permissions)||void 0===n?void 0:n.jsonrpc)&&(null===(i=e.jsonrpc)||void 0===i?void 0:i.methods)&&o.hasOverlap(e.jsonrpc.methods,t.permissions.jsonrpc.methods)&&(u=!0),(null===(r=t.permissions)||void 0===r?void 0:r.blockchain)&&(null===(s=e.blockchain)||void 0===s?void 0:s.chains)&&o.hasOverlap(e.blockchain.chains,t.permissions.blockchain.chains)&&(u=!0),(null===(a=t.permissions)||void 0===a?void 0:a.notifications)&&(null===(c=e.notifications)||void 0===c?void 0:c.types)&&o.hasOverlap(e.notifications.types,t.permissions.notifications.types)&&(u=!0),u}))}))}ping(e,t){return i.__awaiter(this,void 0,void 0,(function*(){const n={method:this.sequence.config.jsonrpc.ping,params:{}};return this.request({topic:e,request:n,timeout:t||1e3*a.THIRTY_SECONDS})}))}send(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){const i=yield this.sequence.settled.get(e);if(s.isJsonRpcRequest(t)){if(!Object.values(this.sequence.config.jsonrpc).includes(t.method)){yield this.isJsonRpcAuthorized(e,i.self,t),yield this.sequence.validateRequest({topic:e,request:t,chainId:n}),yield this.sequence.history.set(e,t,n);const r={chainId:n,request:{method:t.method,params:t.params}};r.chainId||delete r.chainId,t=s.formatJsonRpcRequest(this.sequence.config.jsonrpc.payload,r,t.id)}}else yield this.sequence.history.update(e,t);yield this.sequence.client.relayer.publish(i.topic,t,{relay:i.relay})}))}get length(){return this.sequence.settled.length}get topics(){return this.sequence.settled.topics}get values(){return this.sequence.settled.values.map((e=>e.data))}create(e){return new Promise(((t,n)=>i.__awaiter(this,void 0,void 0,(function*(){this.sequence.logger.debug(`Create ${this.sequence.context}`),this.sequence.logger.trace({type:"method",method:"create",params:e});const r=(null===e||void 0===e?void 0:e.timeout)||1e3*a.FIVE_MINUTES,s=setTimeout((()=>{const e=o.ERROR.SETTLE_TIMEOUT.format({context:this.sequence.context,timeout:r});this.sequence.logger.error(e.message),n(e.message)}),r);let c;try{c=yield this.propose(e)}catch(u){return clearTimeout(s),n(u)}this.sequence.pending.on(a.SUBSCRIPTION_EVENTS.updated,(e=>i.__awaiter(this,void 0,void 0,(function*(){if(c.topic===e.data.topic&&o.isSequenceResponded(e.data)){const i=e.data.outcome;if(clearTimeout(s),o.isSequenceFailed(i)){try{yield this.sequence.pending.delete(c.topic,i.reason)}catch(u){return n(u)}n(new Error(i.reason.message))}else try{const e=yield this.sequence.settled.get(i.topic),n=o.ERROR.SETTLED.format({context:this.sequence.context});yield this.sequence.pending.delete(c.topic,n),t(e)}catch(u){return n(u)}}}))))}))))}respond(e){return i.__awaiter(this,void 0,void 0,(function*(){this.sequence.logger.debug(`Respond ${this.sequence.context}`),this.sequence.logger.trace({type:"method",method:"respond",params:e}),yield this.sequence.validateRespond(e);const{approved:t,proposal:n,response:i}=e,{relay:r,ttl:s}=n,a={publicKey:yield this.sequence.client.crypto.generateKeyPair(),metadata:null===i||void 0===i?void 0:i.metadata};if(a.metadata||delete a.metadata,!t){const t=o.ERROR.NOT_APPROVED.format({context:this.sequence.context}),i={reason:(null===e||void 0===e?void 0:e.reason)||t},s={status:this.sequence.config.status.responded,topic:n.topic,relay:r,self:a,proposal:n,outcome:i};return yield this.sequence.pending.set(s.topic,s,{relay:s.relay}),s}try{const e={publicKey:a.publicKey,metadata:null===i||void 0===i?void 0:i.metadata};e.metadata||delete e.metadata;const t=Date.now()+1e3*n.ttl,o=(null===i||void 0===i?void 0:i.state)||{},c={publicKey:n.proposer.publicKey,metadata:n.proposer.metadata};c.metadata||delete c.metadata;const u=n.proposer.controller?{publicKey:c.publicKey}:{publicKey:a.publicKey},d=Object.assign(Object.assign({},n.permissions),{controller:u}),l={topic:(yield this.settle({relay:r,self:a,peer:c,permissions:d,state:o,ttl:s,expiry:t})).topic,relay:r,state:o,responder:e,expiry:t},f={status:this.sequence.config.status.responded,topic:n.topic,relay:r,self:a,proposal:n,outcome:l};return yield this.sequence.pending.set(f.topic,f,{relay:f.relay}),f}catch(c){const e={reason:o.ERROR.GENERIC.format({message:c.message})},t={status:this.sequence.config.status.responded,topic:n.topic,relay:r,self:a,proposal:n,outcome:e};return yield this.sequence.pending.set(t.topic,t,{relay:t.relay}),t}}))}update(e){return i.__awaiter(this,void 0,void 0,(function*(){this.sequence.logger.debug(`Update ${this.sequence.context}`),this.sequence.logger.trace({type:"method",method:"update",params:e});const t=yield this.sequence.settled.get(e.topic),n={publicKey:t.self.publicKey},i=yield this.handleUpdate(e.topic,e,n),r=s.formatJsonRpcRequest(this.sequence.config.jsonrpc.update,i);return yield this.send(t.topic,r),t}))}upgrade(e){return i.__awaiter(this,void 0,void 0,(function*(){this.sequence.logger.debug(`Upgrade ${this.sequence.context}`),this.sequence.logger.trace({type:"method",method:"upgrade",params:e});const t=yield this.sequence.settled.get(e.topic),n={publicKey:t.self.publicKey},i=yield this.handleUpgrade(e.topic,e,n),r=s.formatJsonRpcRequest(this.sequence.config.jsonrpc.upgrade,i);return yield this.send(t.topic,r),t}))}request(e){return i.__awaiter(this,void 0,void 0,(function*(){return new Promise(((t,n)=>i.__awaiter(this,void 0,void 0,(function*(){try{yield this.sequence.validateRequest(e)}catch(u){return n(u)}const i=s.formatJsonRpcRequest(e.request.method,e.request.params),r=(null===e||void 0===e?void 0:e.timeout)||1e3*a.FIVE_MINUTES,c=setTimeout((()=>{const e=o.ERROR.JSONRPC_REQUEST_TIMEOUT.format({method:i.method,timeout:r});this.sequence.logger.error(e.message),n(e.message)}),r);this.sequence.events.on(this.sequence.config.events.response,(r=>{if(e.topic!==r.topic)return;const o=r.response;if(o.id===i.id){if(clearTimeout(c),s.isJsonRpcError(o)){const e=o.error.message;return this.sequence.logger.error(e),n(new Error(e))}return t(o.result)}}));try{yield this.send(e.topic,i,null===e||void 0===e?void 0:e.chainId)}catch(u){return clearTimeout(c),n(u)}}))))}))}delete(e){return i.__awaiter(this,void 0,void 0,(function*(){this.sequence.logger.debug(`Delete ${this.sequence.context}`),this.sequence.logger.trace({type:"method",method:"delete",params:e}),yield this.sequence.settled.delete(e.topic,e.reason)}))}notify(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=yield this.sequence.settled.get(e.topic);yield this.isNotificationAuthorized(e.topic,t.self,e.type);const n={type:e.type,data:e.data},i=s.formatJsonRpcRequest(this.sequence.config.jsonrpc.notification,n);yield this.send(e.topic,i)}))}propose(e){return i.__awaiter(this,void 0,void 0,(function*(){this.sequence.logger.debug(`Propose ${this.sequence.context}`),this.sequence.logger.trace({type:"method",method:"propose",params:e}),yield this.sequence.validatePropose(e);const t=(null===e||void 0===e?void 0:e.relay)||{protocol:a.RELAYER_DEFAULT_PROTOCOL},n=o.generateRandomBytes32(),i={publicKey:yield this.sequence.client.crypto.generateKeyPair(),metadata:null===e||void 0===e?void 0:e.metadata};i.metadata||delete i.metadata;const r={publicKey:i.publicKey,controller:this.sequence.client.controller,metadata:i.metadata};r.metadata||delete r.metadata;const s={relay:t,topic:n,proposer:r,signal:(null===e||void 0===e?void 0:e.signal)||(yield this.sequence.getDefaultSignal({topic:n,relay:t,proposer:r})),permissions:(null===e||void 0===e?void 0:e.permissions)||(yield this.sequence.getDefaultPermissions()),ttl:(null===e||void 0===e?void 0:e.ttl)||(yield this.sequence.getDefaultTTL())},c={status:this.sequence.config.status.proposed,topic:s.topic,relay:s.relay,self:i,proposal:s};return yield this.sequence.pending.set(c.topic,c,{relay:t}),c}))}settle(e){return i.__awaiter(this,void 0,void 0,(function*(){this.sequence.logger.debug(`Settle ${this.sequence.context}`),this.sequence.logger.trace({type:"method",method:"settle",params:e});const t={topic:yield this.sequence.client.crypto.generateSharedKey(e.self,e.peer),relay:e.relay,self:e.self,peer:e.peer,permissions:e.permissions,expiry:e.expiry,state:e.state};return yield this.sequence.settled.set(t.topic,t,{relay:t.relay,expiry:t.expiry}),t}))}onResponse(e){return i.__awaiter(this,void 0,void 0,(function*(){const{topic:t,payload:n}=e;this.sequence.logger.debug(`Receiving ${this.sequence.context} response`),this.sequence.logger.trace({type:"method",method:"onResponse",topic:t,payload:n});const i=n,r=i.params,a=yield this.sequence.pending.get(t);let c;if(o.isSequenceFailed(r))this.sequence.logger.error(r.reason),yield this.sequence.pending.update(t,{status:this.sequence.config.status.responded,outcome:{reason:r.reason}});else{try{const e=a.proposal.proposer.controller?{publicKey:a.proposal.proposer.publicKey}:{publicKey:r.responder.publicKey},n={publicKey:r.responder.publicKey,metadata:r.responder.metadata};n.metadata||delete n.metadata;const i=r.state||{},o=Object.assign(Object.assign({},a.proposal.permissions),{controller:e}),s=yield this.settle({relay:a.relay,self:a.self,peer:n,permissions:o,ttl:a.proposal.ttl,expiry:r.expiry,state:i});yield this.sequence.pending.update(t,{status:this.sequence.config.status.responded,outcome:{topic:s.topic,relay:s.relay,responder:r.responder,expiry:s.expiry,state:s.state}})}catch(u){this.sequence.logger.error(u),c=o.ERROR.GENERIC.format({message:u.message}),yield this.sequence.pending.update(t,{status:this.sequence.config.status.responded,outcome:{reason:c}})}const e="undefined"===typeof c?s.formatJsonRpcResult(i.id,!0):s.formatJsonRpcError(i.id,c);yield this.sequence.client.relayer.publish(a.topic,e,{relay:a.relay})}}))}onAcknowledge(e){return i.__awaiter(this,void 0,void 0,(function*(){const{topic:t,payload:n}=e;this.sequence.logger.debug(`Receiving ${this.sequence.context} acknowledge`),this.sequence.logger.trace({type:"method",method:"onAcknowledge",topic:t,payload:n});const i=n,r=yield this.sequence.pending.get(t);if(!o.isSequenceResponded(r))return;s.isJsonRpcError(i)&&!o.isSequenceFailed(r.outcome)&&(yield this.sequence.settled.delete(r.outcome.topic,i.error));const a=o.ERROR.RESPONSE_ACKNOWLEDGED.format({context:this.sequence.context});yield this.sequence.pending.delete(t,a)}))}onMessage(e){return i.__awaiter(this,void 0,void 0,(function*(){const{topic:t,payload:n}=e;if(this.sequence.logger.debug(`Receiving ${this.sequence.context} message`),this.sequence.logger.trace({type:"method",method:"onMessage",topic:t,payload:n}),s.isJsonRpcRequest(n)){const t=n,i=yield this.sequence.settled.get(e.topic);let r;switch(t.method){case this.sequence.config.jsonrpc.payload:yield this.onPayload(e);break;case this.sequence.config.jsonrpc.update:yield this.onUpdate(e);break;case this.sequence.config.jsonrpc.upgrade:yield this.onUpgrade(e);break;case this.sequence.config.jsonrpc.notification:yield this.onNotification(e);break;case this.sequence.config.jsonrpc.delete:yield this.sequence.settled.delete(i.topic,t.params.reason);break;case this.sequence.config.jsonrpc.ping:yield this.send(i.topic,s.formatJsonRpcResult(t.id,!0));break;default:r=o.ERROR.UNKNOWN_JSONRPC_METHOD.format({method:t.method}),this.sequence.logger.error(r.message),yield this.send(i.topic,s.formatJsonRpcError(t.id,r))}}else this.onPayloadEvent(e)}))}onPayload(e){return i.__awaiter(this,void 0,void 0,(function*(){const{topic:t,payload:n}=e;if(s.isJsonRpcRequest(n)){const{id:e,params:i}=n,{chainId:r}=i,o=s.formatJsonRpcRequest(i.request.method,i.request.params,e),a=yield this.sequence.settled.get(t);yield this.isJsonRpcAuthorized(t,a.peer,o),yield this.sequence.validateRequest({topic:t,request:o,chainId:r});const c={topic:t,payload:o,chainId:r};this.sequence.logger.debug(`Receiving ${this.sequence.context} payload`),this.sequence.logger.trace(Object.assign({type:"method",method:"onPayload"},c)),this.onPayloadEvent(c)}else{const e={topic:t,payload:n};this.sequence.logger.debug(`Receiving ${this.sequence.context} payload`),this.sequence.logger.trace(Object.assign({type:"method",method:"onPayload"},e)),this.onPayloadEvent(e)}}))}onUpdate(e){return i.__awaiter(this,void 0,void 0,(function*(){const{topic:t,payload:n}=e;this.sequence.logger.debug(`Receiving ${this.sequence.context} update`),this.sequence.logger.trace({type:"method",method:"onUpdate",topic:t,payload:n});const i=e.payload,r=yield this.sequence.settled.get(e.topic);try{const e={publicKey:r.peer.publicKey};yield this.handleUpdate(t,i.params,e);const n=s.formatJsonRpcResult(i.id,!0);yield this.send(r.topic,n)}catch(o){this.sequence.logger.error(o);const e=s.formatJsonRpcError(i.id,o.message);yield this.send(r.topic,e)}}))}onUpgrade(e){return i.__awaiter(this,void 0,void 0,(function*(){const{topic:t,payload:n}=e;this.sequence.logger.debug(`Receiving ${this.sequence.context} upgrade`),this.sequence.logger.trace({type:"method",method:"onUpgrade",topic:t,payload:n});const i=e.payload,r=yield this.sequence.settled.get(e.topic);try{const e={publicKey:r.peer.publicKey};yield this.handleUpgrade(t,i.params,e);const n=s.formatJsonRpcResult(i.id,!0);yield this.send(r.topic,n)}catch(o){this.sequence.logger.error(o);const e=s.formatJsonRpcError(i.id,o.message);yield this.send(r.topic,e)}}))}onNotification(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=e.payload.params,n=yield this.sequence.settled.get(e.topic);yield this.isNotificationAuthorized(e.topic,n.peer,t.type);const i={topic:e.topic,type:t.type,data:t.data},r=this.sequence.config.events.notification;this.sequence.logger.info(`Emitting ${r}`),this.sequence.logger.debug({type:"event",event:r,notificationEvent:i}),this.sequence.events.emit(r,i)}))}handleUpdate(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){if("undefined"===typeof t.state){const e=o.ERROR.INVALID_UPDATE_REQUEST.format({context:this.sequence.context});throw this.sequence.logger.error(e.message),new Error(e.message)}const i=yield this.sequence.settled.get(e);if(n.publicKey!==i.permissions.controller.publicKey){const e=o.ERROR.UNAUTHORIZED_UPDATE_REQUEST.format({context:this.sequence.context});throw this.sequence.logger.error(e.message),new Error(e.message)}return i.state=yield this.sequence.mergeUpdate(e,t),yield this.sequence.settled.update(i.topic,i),t}))}handleUpgrade(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){if("undefined"===typeof t.permissions){const e=o.ERROR.INVALID_UPGRADE_REQUEST.format({context:this.sequence.context});throw this.sequence.logger.error(e.message),new Error(e.message)}const i=yield this.sequence.settled.get(e);if(n.publicKey!==i.permissions.controller.publicKey){const e=o.ERROR.UNAUTHORIZED_UPGRADE_REQUEST.format({context:this.sequence.context});throw this.sequence.logger.error(e.message),new Error(e.message)}return i.permissions=yield this.sequence.mergeUpgrade(e,t),yield this.sequence.settled.update(i.topic,i),t}))}isJsonRpcAuthorized(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){const i=yield this.sequence.settled.get(e);if(t.publicKey!==i.permissions.controller.publicKey&&!i.permissions.jsonrpc.methods.includes(n.method)){const e=o.ERROR.UNAUTHORIZED_JSON_RPC_METHOD.format({method:n.method});throw this.sequence.logger.error(e.message),new Error(e.message)}}))}isNotificationAuthorized(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){const i=yield this.sequence.settled.get(e);if(t.publicKey!==i.permissions.controller.publicKey&&i.self.publicKey!==i.permissions.controller.publicKey&&!i.permissions.notifications.types.includes(n)){const e=o.ERROR.UNAUTHORIZED_NOTIFICATION_TYPE.format({type:n});throw this.sequence.logger.error(e.message),new Error(e.message)}}))}shouldIgnorePayloadEvent(e){return i.__awaiter(this,void 0,void 0,(function*(){const{topic:t,payload:n}=e;if(!this.sequence.settled.subscriptions.has(t))return!0;let i=!1;try{i=yield this.sequence.history.exists(t,n.id)}catch(r){}return i}))}onPayloadEvent(e){return i.__awaiter(this,void 0,void 0,(function*(){const{topic:t,payload:n,chainId:i}=e;if(s.isJsonRpcRequest(n)){if(yield this.shouldIgnorePayloadEvent(e))return;yield this.sequence.history.set(t,n,i)}else yield this.sequence.history.update(t,n);if(s.isJsonRpcRequest(n)){const e={topic:t,request:n,chainId:i},r=this.sequence.config.events.request;this.sequence.logger.info(`Emitting ${r}`),this.sequence.logger.debug({type:"event",event:r,data:e}),this.sequence.events.emit(r,e)}else{const e={topic:t,response:n,chainId:i},r=this.sequence.config.events.response;this.sequence.logger.info(`Emitting ${r}`),this.sequence.logger.debug({type:"event",event:r,data:e}),this.sequence.events.emit(r,e)}}))}onPendingPayloadEvent(e){return i.__awaiter(this,void 0,void 0,(function*(){if(s.isJsonRpcRequest(e.payload))switch(e.payload.method){case this.sequence.config.jsonrpc.approve:case this.sequence.config.jsonrpc.reject:this.onResponse(e)}else this.onAcknowledge(e)}))}onPendingStatusEvent(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=e.data;if(o.isSignalTypePairing(t.proposal.signal)&&!(yield this.sequence.client.crypto.hasKeys(t.proposal.topic))){const e=yield this.sequence.client.pairing.settled.get(t.proposal.signal.params.topic);yield this.sequence.client.crypto.generateSharedKey(e.self,e.peer,t.proposal.topic)}if(o.isSequenceResponded(t)){const n=this.sequence.config.events.responded;if(this.sequence.logger.info(`Emitting ${n}`),this.sequence.logger.debug({type:"event",event:n,data:t}),this.sequence.events.emit(n,t),!o.isSubscriptionUpdatedEvent(e)){const e=o.isSequenceFailed(t.outcome)?this.sequence.config.jsonrpc.reject:this.sequence.config.jsonrpc.approve,n=s.formatJsonRpcRequest(e,t.outcome);yield this.sequence.client.relayer.publish(t.topic,n,{relay:t.relay})}}else{const e=this.sequence.config.events.proposed;if(this.sequence.logger.info(`Emitting ${e}`),this.sequence.logger.debug({type:"event",event:e,data:t}),this.sequence.events.emit(e,t),o.isSignalTypePairing(t.proposal.signal)){const e=s.formatJsonRpcRequest(this.sequence.config.jsonrpc.propose,t.proposal);yield this.sequence.client.pairing.send(t.proposal.signal.params.topic,e)}}}))}registerEventListeners(){this.sequence.pending.on(a.SUBSCRIPTION_EVENTS.payload,(e=>this.onPendingPayloadEvent(e))),this.sequence.pending.on(a.SUBSCRIPTION_EVENTS.created,(e=>this.onPendingStatusEvent(e))),this.sequence.pending.on(a.SUBSCRIPTION_EVENTS.updated,(e=>this.onPendingStatusEvent(e))),this.sequence.settled.on(a.SUBSCRIPTION_EVENTS.payload,(e=>this.onMessage(e))),this.sequence.settled.on(a.SUBSCRIPTION_EVENTS.created,(e=>{const{data:t}=e,n=this.sequence.config.events.settled;this.sequence.logger.info(`Emitting ${n}`),this.sequence.logger.debug({type:"event",event:n,data:t}),this.sequence.events.emit(n,t)})),this.sequence.settled.on(a.SUBSCRIPTION_EVENTS.updated,(e=>{const{data:t,update:n}=e,i=this.sequence.config.events.updated;this.sequence.logger.info(`Emitting ${i}`),this.sequence.logger.debug({type:"event",event:i,data:t,update:n}),this.sequence.events.emit(i,t,n)})),this.sequence.settled.on(a.SUBSCRIPTION_EVENTS.deleted,(e=>i.__awaiter(this,void 0,void 0,(function*(){const{data:t,reason:n}=e,i=this.sequence.config.events.deleted;this.sequence.logger.info(`Emitting ${i}`),this.sequence.logger.debug({type:"event",event:i,data:t,reason:n}),this.sequence.events.emit(i,t,n);const r=s.formatJsonRpcRequest(this.sequence.config.jsonrpc.delete,{reason:n});yield this.sequence.history.delete(t.topic),yield this.sequence.client.relayer.publish(t.topic,r,{relay:t.relay})})))),this.sequence.settled.on(a.SUBSCRIPTION_EVENTS.sync,(()=>this.sequence.events.emit(this.sequence.config.events.sync))),this.sequence.settled.on(a.SUBSCRIPTION_EVENTS.enabled,(()=>this.sequence.events.emit(this.sequence.config.events.enabled))),this.sequence.settled.on(a.SUBSCRIPTION_EVENTS.disabled,(()=>this.sequence.events.emit(this.sequence.config.events.disabled)))}}t.Engine=c},1994:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JsonRpcHistory=void 0;const i=n(655),r=n(7187),o=n(3609),s=n(5094),a=n(6186),c=n(9107),u=n(7702);class d extends o.IJsonRpcHistory{constructor(e,t){super(e,t),this.client=e,this.logger=t,this.records=new Map,this.events=new r.EventEmitter,this.context=u.HISTORY_CONTEXT,this.cached=[],this.client,this.logger=c.generateChildLogger(t,this.context),this.registerEventListeners()}init(){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.trace("Initialized"),yield this.restore()}))}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach((t=>{if("undefined"!==typeof t.response)return;const n={topic:t.topic,request:a.formatJsonRpcRequest(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(n)})),e}set(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){if(yield this.isEnabled(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:n}),this.records.has(t.id)){const e=s.ERROR.RECORD_ALREADY_EXISTS.format({context:this.getHistoryContext(),id:t.id});throw this.logger.error(e.message),new Error(e.message)}const i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:n};this.records.set(i.id,i),this.events.emit(u.HISTORY_EVENTS.created,i)}))}update(e,t){return i.__awaiter(this,void 0,void 0,(function*(){if(yield this.isEnabled(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",topic:e,response:t}),!this.records.has(t.id))return;const n=yield this.getRecord(t.id);n.topic===e&&"undefined"===typeof n.response&&(n.response=a.isJsonRpcError(t)?{error:t.error}:{result:t.result},this.records.set(n.id,n),this.events.emit(u.HISTORY_EVENTS.updated,n))}))}get(e,t){return i.__awaiter(this,void 0,void 0,(function*(){yield this.isEnabled(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t});const n=yield this.getRecord(t);if(n.topic!==e){const e=s.ERROR.MISMATCHED_TOPIC.format({context:this.getHistoryContext(),id:t});throw this.logger.error(e.message),new Error(e.message)}return n}))}delete(e,t){return i.__awaiter(this,void 0,void 0,(function*(){yield this.isEnabled(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach((n=>{if(n.topic===e){if("undefined"!==typeof t&&n.id!==t)return;this.records.delete(n.id),this.events.emit(u.HISTORY_EVENTS.deleted,n)}}))}))}exists(e,t){return i.__awaiter(this,void 0,void 0,(function*(){if(yield this.isEnabled(),!this.records.has(t))return!1;return(yield this.getRecord(t)).topic===e}))}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}getNestedContext(e){const t=c.getLoggerContext(this.logger).split("/");return t.slice(t.length-e,t.length)}getHistoryContext(){return this.getNestedContext(2).join(" ")}getStorageKey(){return`${`${this.client.protocol}@${this.client.version}:${this.client.context}`}//${this.getNestedContext(2).join(":")}`}getRecord(e){return i.__awaiter(this,void 0,void 0,(function*(){yield this.isEnabled();const t=this.records.get(e);if(!t){const t=s.ERROR.NO_MATCHING_ID.format({context:this.getHistoryContext(),id:e});throw this.logger.error(t.message),new Error(t.message)}return t}))}persist(){return i.__awaiter(this,void 0,void 0,(function*(){yield this.client.storage.setItem(this.getStorageKey(),this.values),this.events.emit(u.HISTORY_EVENTS.sync)}))}restore(){return i.__awaiter(this,void 0,void 0,(function*(){try{const e=yield this.client.storage.getItem(this.getStorageKey());if("undefined"===typeof e)return;if(!e.length)return;if(this.records.size){const e=s.ERROR.RESTORE_WILL_OVERRIDE.format({context:this.getHistoryContext()});throw this.logger.error(e.message),new Error(e.message)}this.cached=e,yield Promise.all(this.cached.map((e=>i.__awaiter(this,void 0,void 0,(function*(){this.records.set(e.id,e)}))))),yield this.enable(),this.logger.debug(`Successfully Restored records for ${this.getHistoryContext()}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.getHistoryContext()}`),this.logger.error(e)}}))}reset(){return i.__awaiter(this,void 0,void 0,(function*(){yield this.disable(),yield Promise.all(this.cached.map((e=>i.__awaiter(this,void 0,void 0,(function*(){this.records.set(e.id,e)}))))),yield this.enable()}))}isEnabled(){return i.__awaiter(this,void 0,void 0,(function*(){if(this.cached.length)return new Promise((e=>{this.events.once(u.HISTORY_EVENTS.enabled,(()=>e()))}))}))}enable(){return i.__awaiter(this,void 0,void 0,(function*(){this.cached=[],this.events.emit(u.HISTORY_EVENTS.enabled)}))}disable(){return i.__awaiter(this,void 0,void 0,(function*(){this.cached.length||(this.cached=this.values),this.events.emit(u.HISTORY_EVENTS.disabled)}))}registerEventListeners(){this.events.on(u.HISTORY_EVENTS.created,(e=>{const t=u.HISTORY_EVENTS.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})),this.events.on(u.HISTORY_EVENTS.updated,(e=>{const t=u.HISTORY_EVENTS.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()})),this.events.on(u.HISTORY_EVENTS.deleted,(e=>{const t=u.HISTORY_EVENTS.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}))}}t.JsonRpcHistory=d},768:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(655);i.__exportStar(n(2264),t),i.__exportStar(n(424),t),i.__exportStar(n(7997),t),i.__exportStar(n(3170),t)},2264:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pairing=void 0;const i=n(655),r=n(7187),o=n(9107),s=n(3609),a=n(5094),c=n(3170),u=n(1994),d=n(6327),l=n(7702);class f extends s.IPairing{constructor(e,t){super(e,t),this.client=e,this.logger=t,this.events=new r.EventEmitter,this.context=l.PAIRING_CONTEXT,this.config={status:l.PAIRING_STATUS,events:l.PAIRING_EVENTS,jsonrpc:l.PAIRING_JSONRPC},this.logger=o.generateChildLogger(t,this.context),this.pending=new c.Subscription(e,this.logger,this.config.status.pending),this.settled=new c.Subscription(e,this.logger,this.config.status.settled),this.history=new u.JsonRpcHistory(e,this.logger),this.engine=new d.Engine(this)}init(){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.trace("Initialized"),yield this.pending.init(),yield this.settled.init(),yield this.history.init()}))}get(e){return this.settled.get(e)}find(e){return this.engine.find(e)}ping(e,t){return this.engine.ping(e,t)}send(e,t){return this.engine.send(e,t)}get length(){return this.settled.length}get topics(){return this.settled.topics}get values(){return this.settled.values.map((e=>e.data))}create(e){return this.engine.create(e)}respond(e){return this.engine.respond(e)}upgrade(e){return this.engine.upgrade(e)}update(e){return this.engine.update(e)}request(e){return this.engine.request(e)}delete(e){return this.engine.delete(e)}notify(e){return this.engine.notify(e)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}mergeUpdate(e,t){return i.__awaiter(this,void 0,void 0,(function*(){const n=yield this.settled.get(e);return{metadata:t.state.metadata||n.state.metadata}}))}mergeUpgrade(e,t){var n,r,o;return i.__awaiter(this,void 0,void 0,(function*(){const i=yield this.settled.get(e);return{jsonrpc:{methods:[...i.permissions.jsonrpc.methods,...(null===(n=t.permissions.jsonrpc)||void 0===n?void 0:n.methods)||[]]},notifications:{types:[...null===(r=i.permissions.notifications)||void 0===r?void 0:r.types,...(null===(o=t.permissions.notifications)||void 0===o?void 0:o.types)||[]]},controller:i.permissions.controller}}))}validateRespond(e){return i.__awaiter(this,void 0,void 0,(function*(){}))}validateRequest(e){return i.__awaiter(this,void 0,void 0,(function*(){}))}validatePropose(e){return i.__awaiter(this,void 0,void 0,(function*(){}))}getDefaultSignal({topic:e,relay:t,proposer:n}){return i.__awaiter(this,void 0,void 0,(function*(){const i=a.formatUri({protocol:this.client.protocol,version:this.client.version,topic:e,publicKey:n.publicKey,controller:n.controller,relay:t});return{method:l.PAIRING_SIGNAL_METHOD_URI,params:{uri:i}}}))}getDefaultTTL(){return i.__awaiter(this,void 0,void 0,(function*(){return l.PAIRING_DEFAULT_TTL}))}getDefaultPermissions(){return i.__awaiter(this,void 0,void 0,(function*(){return{jsonrpc:{methods:[l.SESSION_JSONRPC.propose]},notifications:{types:[]}}}))}}t.Pairing=f},424:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Relayer=void 0;const i=n(655),r=n(7187),o=n(9107),s=n(3609),a=n(8009),c=n(5094),u=i.__importStar(n(3087)),d=n(6186),l=n(9303),f=n(9855),E=n(1055),h=n(7702);class p extends s.IRelayer{constructor(e,t,n){super(e,t),this.client=e,this.logger=t,this.events=new r.EventEmitter,this.context=h.RELAYER_CONTEXT,this.logger=o.generateChildLogger(t,this.context),this.provider=this.setProvider(n),this.registerEventListeners()}get connected(){return this.provider.connection.connected}init(){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.trace("Initialized"),yield this.provider.connect()}))}publish(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,payload:t,opts:n}});try{const i=(null===n||void 0===n?void 0:n.relay.protocol)||h.RELAYER_DEFAULT_PROTOCOL,r=E.safeJsonStringify(t),o=(yield this.client.crypto.hasKeys(e))?yield this.client.crypto.encrypt(e,r):u.utf8ToHex(r),s={method:R(i).publish,params:{topic:e,message:o,ttl:(null===n||void 0===n?void 0:n.ttl)||h.RELAYER_DEFAULT_PUBLISH_TTL}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),yield this.provider.request(s),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",request:s})}catch(i){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(i),i}}))}subscribe(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:n}});try{const r=(null===n||void 0===n?void 0:n.relay.protocol)||h.RELAYER_DEFAULT_PROTOCOL,o={method:R(r).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o});const s=yield this.provider.request(o);return this.events.on(s,(({message:n})=>i.__awaiter(this,void 0,void 0,(function*(){const i=yield this.client.crypto.hasKeys(e),r=E.safeJsonParse(i?yield this.client.crypto.decrypt(e,n):u.hexToUtf8(n));t(r)})))),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",request:o}),s}catch(r){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(r),r}}))}unsubscribe(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{id:t,opts:n}});try{const i=(null===n||void 0===n?void 0:n.relay.protocol)||h.RELAYER_DEFAULT_PROTOCOL,r={method:R(i).unsubscribe,params:{topic:e,id:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r}),yield this.provider.request(r),this.events.removeAllListeners(t),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",request:r})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}))}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}onPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),d.isJsonRpcRequest(e)&&e.method.endsWith("_subscription")){const t=e.params;this.events.emit(t.id,t.data);const n=d.formatJsonRpcResult(e.id,!0);this.provider.connection.send(n)}}setProvider(e){this.logger.debug("Setting Relay Provider"),this.logger.trace({type:"method",method:"setProvider",provider:null===e||void 0===e?void 0:e.toString()});const t=c.formatRelayRpcUrl(this.client.protocol,this.client.version,"string"===typeof e?e:h.RELAYER_DEFAULT_RPC_URL);return"string"!==typeof e&&"undefined"!==typeof e?e:new l.JsonRpcProvider(new f.WsConnection(t))}registerEventListeners(){this.provider.on("payload",(e=>this.onPayload(e))),this.provider.on("connect",(()=>this.events.emit(h.RELAYER_EVENTS.connect))),this.provider.on("disconnect",(()=>{this.events.emit(h.RELAYER_EVENTS.disconnect),this.provider.connect()})),this.provider.on("error",(e=>this.events.emit(h.RELAYER_EVENTS.error,e)))}}function R(e){const t=a.RELAY_JSONRPC[e];if("undefined"===typeof t)throw new Error(`Relay Protocol not supported: ${e}`);return t}t.Relayer=p},7997:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;const i=n(655),r=n(7187),o=n(9107),s=n(3609),a=n(5094),c=n(3170),u=n(1994),d=n(7702),l=n(6327);class f extends s.ISession{constructor(e,t){super(e,t),this.client=e,this.logger=t,this.events=new r.EventEmitter,this.context=d.SESSION_CONTEXT,this.config={status:d.SESSION_STATUS,events:d.SESSION_EVENTS,jsonrpc:d.SESSION_JSONRPC},this.logger=o.generateChildLogger(t,this.context),this.pending=new c.Subscription(e,this.logger,this.config.status.pending),this.settled=new c.Subscription(e,this.logger,this.config.status.settled),this.history=new u.JsonRpcHistory(e,this.logger),this.engine=new l.Engine(this)}init(){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.trace("Initialized"),yield this.pending.init(),yield this.settled.init(),yield this.history.init()}))}get(e){return this.settled.get(e)}find(e){return this.engine.find(e)}ping(e,t){return this.engine.ping(e,t)}send(e,t,n){return this.engine.send(e,t,n)}get length(){return this.settled.length}get topics(){return this.settled.topics}get values(){return this.settled.values.map((e=>e.data))}create(e){return this.engine.create(e)}respond(e){return this.engine.respond(e)}upgrade(e){return this.engine.upgrade(e)}update(e){return this.engine.update(e)}request(e){return this.engine.request(e)}delete(e){return this.engine.delete(e)}notify(e){return this.engine.notify(e)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}mergeUpdate(e,t){var n;return i.__awaiter(this,void 0,void 0,(function*(){const i=yield this.settled.get(e);return{accounts:(null===(n=t.state)||void 0===n?void 0:n.accounts)||i.state.accounts}}))}mergeUpgrade(e,t){var n,r,o,s,a;return i.__awaiter(this,void 0,void 0,(function*(){const i=yield this.settled.get(e);return{jsonrpc:{methods:[...i.permissions.jsonrpc.methods,...(null===(n=t.permissions.jsonrpc)||void 0===n?void 0:n.methods)||[]]},notifications:{types:[...null===(r=i.permissions.notifications)||void 0===r?void 0:r.types,...(null===(o=t.permissions.notifications)||void 0===o?void 0:o.types)||[]]},blockchain:{chains:[...null===(s=i.permissions.blockchain)||void 0===s?void 0:s.chains,...(null===(a=t.permissions.blockchain)||void 0===a?void 0:a.chains)||[]]},controller:i.permissions.controller}}))}validateRespond(e){return i.__awaiter(this,void 0,void 0,(function*(){if("undefined"===typeof e){const e=a.ERROR.MISSING_OR_INVALID.format({name:"respond params"});throw this.logger.error(e.message),new Error(e.message)}const t=a.validateSessionRespondParams(e);if(a.isValidationInvalid(t))throw this.logger.error(t.error.message),new Error(t.error.message)}))}validateRequest(e){return i.__awaiter(this,void 0,void 0,(function*(){if("undefined"===typeof e){const e=a.ERROR.MISSING_OR_INVALID.format({name:"request params"});throw this.logger.error(e.message),new Error(e.message)}const{topic:t,chainId:n}=e,i=yield this.settled.get(t);if(n&&!i.permissions.blockchain.chains.includes(n)){const e=a.ERROR.UNAUTHORIZED_TARGET_CHAIN.format({chainId:n});throw this.logger.error(e.message),new Error(e.message)}}))}validatePropose(e){return i.__awaiter(this,void 0,void 0,(function*(){if("undefined"===typeof e){const e=a.ERROR.MISSING_OR_INVALID.format({name:"propose params"});throw this.logger.error(e.message),new Error(e.message)}const t=a.validateSessionProposeParams(e);if(a.isValidationInvalid(t))throw this.logger.error(t.error.message),new Error(t.error.message);if(e.signal.method!==d.SESSION_SIGNAL_METHOD_PAIRING){const e=a.ERROR.UNSUPPORTED_SIGNAL.format({context:this.context});throw this.logger.error(e.message),new Error(e.message)}}))}getDefaultSignal(e){return i.__awaiter(this,void 0,void 0,(function*(){const t=yield this.client.pairing.settled.get(e.topic);return{method:d.SESSION_SIGNAL_METHOD_PAIRING,params:{topic:t.topic}}}))}getDefaultTTL(){return i.__awaiter(this,void 0,void 0,(function*(){return d.SESSION_DEFAULT_TTL}))}getDefaultPermissions(){return i.__awaiter(this,void 0,void 0,(function*(){return{jsonrpc:{methods:[]},notifications:{types:[]},blockchain:{chains:[]}}}))}}t.Session=f},3170:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Subscription=void 0;const i=n(655),r=n(7187),o=n(3609),s=n(5094),a=n(7702),c=n(9107);class u extends o.ISubscription{constructor(e,t,n){super(e,t,n),this.client=e,this.logger=t,this.context=n,this.subscriptions=new Map,this.events=new r.EventEmitter,this.timeout=new Map,this.cached=[],this.logger=c.generateChildLogger(t,this.context),this.registerEventListeners()}init(){return i.__awaiter(this,void 0,void 0,(function*(){this.logger.trace("Initialized"),yield this.restore()}))}get length(){return this.subscriptions.size}get topics(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}set(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){yield this.isEnabled(),this.subscriptions.has(e)?this.update(e,t):(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"set",topic:e,data:t,opts:n}),yield this.subscribeAndSet(e,t,n),this.events.emit(a.SUBSCRIPTION_EVENTS.created,{topic:e,data:t}))}))}get(e){return i.__awaiter(this,void 0,void 0,(function*(){yield this.isEnabled(),this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"get",topic:e});return(yield this.getSubscription(e)).data}))}update(e,t){return i.__awaiter(this,void 0,void 0,(function*(){yield this.isEnabled(),this.logger.debug("Updating subscription"),this.logger.trace({type:"method",method:"update",topic:e,update:t});const n=yield this.getSubscription(e),i=Object.assign(Object.assign({},n.data),t);this.subscriptions.set(e,Object.assign(Object.assign({},n),{topic:e,data:i})),this.events.emit(a.SUBSCRIPTION_EVENTS.updated,{topic:e,data:i,update:t})}))}delete(e,t){return i.__awaiter(this,void 0,void 0,(function*(){yield this.isEnabled(),this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"delete",topic:e,reason:t});const n=yield this.getSubscription(e);this.subscriptions.delete(e),yield this.client.relayer.unsubscribe(n.topic,n.id,{relay:n.relay}),this.events.emit(a.SUBSCRIPTION_EVENTS.deleted,{topic:e,data:n.data,reason:t})}))}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}onPayload(e){return i.__awaiter(this,void 0,void 0,(function*(){this.events.emit(a.SUBSCRIPTION_EVENTS.payload,e)}))}getNestedContext(e){const t=c.getLoggerContext(this.logger).split("/");return t.slice(t.length-e,t.length)}getSubscriptionContext(){return this.getNestedContext(2).join(" ")}getStorageKey(){return`${`${this.client.protocol}@${this.client.version}:${this.client.context}`}//${this.getNestedContext(2).join(":")}`}getSubscription(e){return i.__awaiter(this,void 0,void 0,(function*(){yield this.isEnabled();const t=this.subscriptions.get(e);if(!t){const t=s.ERROR.NO_MATCHING_TOPIC.format({context:this.getSubscriptionContext(),topic:e});throw this.logger.error(t.message),new Error(t.message)}return t}))}subscribeAndSet(e,t,n){return i.__awaiter(this,void 0,void 0,(function*(){const i=yield this.client.relayer.subscribe(e,(t=>this.onPayload({topic:e,payload:t})),n),r=n.expiry||Date.now()+1e3*a.SUBSCRIPTION_DEFAULT_TTL;this.subscriptions.set(e,Object.assign(Object.assign({id:i,topic:e,data:t},n),{expiry:r})),this.setTimeout(e,r)}))}setTimeout(e,t){if(this.timeout.has(e))return;const n=t-Date.now();if(n<=0)return void this.onTimeout(e);if(n>a.CLIENT_BEAT_INTERVAL)return;const i=setTimeout((()=>this.onTimeout(e)),n);this.timeout.set(e,i)}deleteTimeout(e){if(!this.timeout.has(e))return;const t=this.timeout.get(e);"undefined"!==typeof t&&clearTimeout(t)}resetTimeout(){this.timeout.forEach((e=>clearTimeout(e))),this.timeout.clear()}onTimeout(e){this.deleteTimeout(e),this.delete(e,s.ERROR.EXPIRED.format({context:this.getSubscriptionContext()}))}checkSubscriptions(){this.subscriptions.forEach((e=>this.setTimeout(e.topic,e.expiry)))}persist(){return i.__awaiter(this,void 0,void 0,(function*(){yield this.client.storage.setItem(this.getStorageKey(),this.values),this.events.emit(a.SUBSCRIPTION_EVENTS.sync)}))}restore(){return i.__awaiter(this,void 0,void 0,(function*(){try{const e=yield this.client.storage.getItem(this.getStorageKey());if("undefined"===typeof e)return;if(!e.length)return;if(this.subscriptions.size){const e=s.ERROR.RESTORE_WILL_OVERRIDE.format({context:this.getSubscriptionContext()});throw this.logger.error(e.message),new Error(e.message)}this.cached=e,yield Promise.all(this.cached.map((e=>i.__awaiter(this,void 0,void 0,(function*(){const{topic:t,data:n}=e,i={relay:e.relay,expiry:e.expiry};yield this.subscribeAndSet(t,n,i)}))))),yield this.enable(),this.logger.debug(`Successfully Restored subscriptions for ${this.getSubscriptionContext()}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.getSubscriptionContext()}`),this.logger.error(e)}}))}reset(){return i.__awaiter(this,void 0,void 0,(function*(){yield this.disable(),yield Promise.all(this.cached.map((e=>i.__awaiter(this,void 0,void 0,(function*(){const{topic:t,data:n}=e,i={relay:e.relay,expiry:e.expiry};yield this.subscribeAndSet(t,n,i)}))))),yield this.enable()}))}isEnabled(){return i.__awaiter(this,void 0,void 0,(function*(){if(this.cached.length)return new Promise((e=>{this.events.once(a.SUBSCRIPTION_EVENTS.enabled,(()=>e()))}))}))}enable(){return i.__awaiter(this,void 0,void 0,(function*(){this.cached=[],this.events.emit(a.SUBSCRIPTION_EVENTS.enabled)}))}disable(){return i.__awaiter(this,void 0,void 0,(function*(){this.cached.length||(this.cached=this.values),this.resetTimeout(),this.events.emit(a.SUBSCRIPTION_EVENTS.disabled)}))}registerEventListeners(){this.client.on(a.CLIENT_EVENTS.beat,(()=>this.checkSubscriptions())),this.client.relayer.on(a.RELAYER_EVENTS.connect,(()=>this.reset())),this.events.on(a.SUBSCRIPTION_EVENTS.payload,(e=>{const t=a.SUBSCRIPTION_EVENTS.payload;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e})})),this.events.on(a.SUBSCRIPTION_EVENTS.created,(e=>{const t=a.SUBSCRIPTION_EVENTS.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})),this.events.on(a.SUBSCRIPTION_EVENTS.updated,(e=>{const t=a.SUBSCRIPTION_EVENTS.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})),this.events.on(a.SUBSCRIPTION_EVENTS.deleted,(e=>{const t=a.SUBSCRIPTION_EVENTS.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}))}}t.Subscription=u},8151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Client=void 0;const i=n(655),r=n(6613);i.__exportStar(n(7702),t),t.Client=r.Client,t.default=r.Client},4961:function(e,t,n){"use strict";var i=n(1468);n.o(i,"ERROR_BAD_MAC")&&n.d(t,{ERROR_BAD_MAC:function(){return i.ERROR_BAD_MAC}}),n.o(i,"IV_LENGTH")&&n.d(t,{IV_LENGTH:function(){return i.IV_LENGTH}}),n.o(i,"KEY_LENGTH")&&n.d(t,{KEY_LENGTH:function(){return i.KEY_LENGTH}}),n.o(i,"LENGTH_0")&&n.d(t,{LENGTH_0:function(){return i.LENGTH_0}}),n.o(i,"MAC_LENGTH")&&n.d(t,{MAC_LENGTH:function(){return i.MAC_LENGTH}}),n.o(i,"assert")&&n.d(t,{assert:function(){return i.assert}}),n.o(i,"decryptWithSharedKey")&&n.d(t,{decryptWithSharedKey:function(){return i.decryptWithSharedKey}}),n.o(i,"derive")&&n.d(t,{derive:function(){return i.derive}}),n.o(i,"encryptWithSharedKey")&&n.d(t,{encryptWithSharedKey:function(){return i.encryptWithSharedKey}}),n.o(i,"generateKeyPair")&&n.d(t,{generateKeyPair:function(){return i.generateKeyPair}}),n.o(i,"isConstantTime")&&n.d(t,{isConstantTime:function(){return i.isConstantTime}})},2102:function(e,t,n){"use strict";n.d(t,{assert:function(){return o.h},isConstantTime:function(){return o.i}});var i=n(4961);n.o(i,"ERROR_BAD_MAC")&&n.d(t,{ERROR_BAD_MAC:function(){return i.ERROR_BAD_MAC}}),n.o(i,"IV_LENGTH")&&n.d(t,{IV_LENGTH:function(){return i.IV_LENGTH}}),n.o(i,"KEY_LENGTH")&&n.d(t,{KEY_LENGTH:function(){return i.KEY_LENGTH}}),n.o(i,"LENGTH_0")&&n.d(t,{LENGTH_0:function(){return i.LENGTH_0}}),n.o(i,"MAC_LENGTH")&&n.d(t,{MAC_LENGTH:function(){return i.MAC_LENGTH}}),n.o(i,"assert")&&n.d(t,{assert:function(){return i.assert}}),n.o(i,"decryptWithSharedKey")&&n.d(t,{decryptWithSharedKey:function(){return i.decryptWithSharedKey}}),n.o(i,"derive")&&n.d(t,{derive:function(){return i.derive}}),n.o(i,"encryptWithSharedKey")&&n.d(t,{encryptWithSharedKey:function(){return i.encryptWithSharedKey}}),n.o(i,"generateKeyPair")&&n.d(t,{generateKeyPair:function(){return i.generateKeyPair}}),n.o(i,"isConstantTime")&&n.d(t,{isConstantTime:function(){return i.isConstantTime}});n(4901);var r=n(1902);n.o(r,"ERROR_BAD_MAC")&&n.d(t,{ERROR_BAD_MAC:function(){return r.ERROR_BAD_MAC}}),n.o(r,"IV_LENGTH")&&n.d(t,{IV_LENGTH:function(){return r.IV_LENGTH}}),n.o(r,"KEY_LENGTH")&&n.d(t,{KEY_LENGTH:function(){return r.KEY_LENGTH}}),n.o(r,"LENGTH_0")&&n.d(t,{LENGTH_0:function(){return r.LENGTH_0}}),n.o(r,"MAC_LENGTH")&&n.d(t,{MAC_LENGTH:function(){return r.MAC_LENGTH}}),n.o(r,"assert")&&n.d(t,{assert:function(){return r.assert}}),n.o(r,"decryptWithSharedKey")&&n.d(t,{decryptWithSharedKey:function(){return r.decryptWithSharedKey}}),n.o(r,"derive")&&n.d(t,{derive:function(){return r.derive}}),n.o(r,"encryptWithSharedKey")&&n.d(t,{encryptWithSharedKey:function(){return r.encryptWithSharedKey}}),n.o(r,"generateKeyPair")&&n.d(t,{generateKeyPair:function(){return r.generateKeyPair}}),n.o(r,"isConstantTime")&&n.d(t,{isConstantTime:function(){return r.isConstantTime}});var o=n(3642)},4901:function(e,t,n){"use strict"},1902:function(){},3642:function(e,t,n){"use strict";function i(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){if(e.length!==t.length)return!1;let n=0;for(let i=0;i<e.length;i++)n|=e[i]^t[i];return 0===n}n.d(t,{h:function(){return i},i:function(){return r}})},3087:function(e,t,n){"use strict";var i=n(8764).Buffer,r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.removeHexLeadingZeros=t.sanitizeHex=t.addHexPrefix=t.removeHexPrefix=t.padRight=t.padLeft=t.sanitizeBytes=t.swapHex=t.swapBytes=t.splitBytes=t.calcByteLength=t.trimRight=t.trimLeft=t.concatArrays=t.concatBuffers=t.getEncoding=t.getType=t.isArrayBuffer=t.isTypedArray=t.isBuffer=t.isHexString=t.isBinaryString=t.binaryToNumber=t.binaryToUtf8=t.binaryToHex=t.binaryToArray=t.binaryToBuffer=t.numberToBinary=t.numberToUtf8=t.numberToHex=t.numberToArray=t.numberToBuffer=t.utf8ToBinary=t.utf8ToNumber=t.utf8ToHex=t.utf8ToArray=t.utf8ToBuffer=t.hexToBinary=t.hexToNumber=t.hexToUtf8=t.hexToArray=t.hexToBuffer=t.arrayToBinary=t.arrayToNumber=t.arrayToUtf8=t.arrayToHex=t.arrayToBuffer=t.bufferToBinary=t.bufferToNumber=t.bufferToUtf8=t.bufferToHex=t.bufferToArray=void 0;const o=r(n(4501)),s=r(n(5054)),a="hex",c="utf8",u="0";function d(e){return new Uint8Array(e)}function l(e,t=!1){const n=e.toString(a);return t?Y(n):n}function f(e){return e.toString(c)}function E(e){return e.readUIntBE(0,e.length)}function h(e){return s.default(e)}function p(e,t=!1){return l(h(e),t)}function R(e){return f(h(e))}function _(e){return E(h(e))}function g(e){return Array.from(e).map(m).join("")}function y(e){return i.from(x(e),a)}function T(e){return d(y(e))}function O(e){return g(T(e))}function v(e){return i.from(e,c)}function S(e){return d(v(e))}function m(e){return H((e>>>0).toString(2))}function N(e){return h(I(e))}function I(e){return new Uint8Array(L(e).map((e=>parseInt(e,2))))}function P(e,t){return p(I(e),t)}function A(e){return!("string"!==typeof e||!new RegExp(/^[01]+$/).test(e))&&e.length%8===0}function C(e,t){return!("string"!==typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!t||e.length===2+2*t)}function b(e){return i.isBuffer(e)}function D(e){return o.default.strict(e)&&!b(e)}function U(e){return!D(e)&&!b(e)&&"undefined"!==typeof e.byteLength}function w(e,t=8){const n=e%t;return n?(e-n)/t*t+t:e}function L(e,t=8){const n=H(e).match(new RegExp(`.{${t}}`,"gi"));return Array.from(n||[])}function M(e){return L(e).map(G).join("")}function H(e,t=8,n="0"){return q(e,w(e.length,t),n)}function q(e,t,n="0"){return V(e,t,!0,n)}function x(e){return e.replace(/^0x/,"")}function Y(e){return e.startsWith("0x")?e:`0x${e}`}function G(e){return e.split("").reverse().join("")}function V(e,t,n,i="0"){const r=t-e.length;let o=e;if(r>0){const t=i.repeat(r);o=n?t+e:e+t}return o}t.bufferToArray=d,t.bufferToHex=l,t.bufferToUtf8=f,t.bufferToNumber=E,t.bufferToBinary=function(e){return g(d(e))},t.arrayToBuffer=h,t.arrayToHex=p,t.arrayToUtf8=R,t.arrayToNumber=_,t.arrayToBinary=g,t.hexToBuffer=y,t.hexToArray=T,t.hexToUtf8=function(e){return f(y(e))},t.hexToNumber=function(e){return _(T(e))},t.hexToBinary=O,t.utf8ToBuffer=v,t.utf8ToArray=S,t.utf8ToHex=function(e,t=!1){return l(v(e),t)},t.utf8ToNumber=function(e){const t=parseInt(e,10);return function(e,t){if(!e)throw new Error(t)}(!function(e){return"undefined"===typeof e}(t),"Number can only safely store up to 53 bits"),t},t.utf8ToBinary=function(e){return g(S(e))},t.numberToBuffer=function(e){return N(m(e))},t.numberToArray=function(e){return I(m(e))},t.numberToHex=function(e,t){return P(m(e),t)},t.numberToUtf8=function(e){return`${e}`},t.numberToBinary=m,t.binaryToBuffer=N,t.binaryToArray=I,t.binaryToHex=P,t.binaryToUtf8=function(e){return R(I(e))},t.binaryToNumber=function(e){return _(I(e))},t.isBinaryString=A,t.isHexString=C,t.isBuffer=b,t.isTypedArray=D,t.isArrayBuffer=U,t.getType=function(e){return b(e)?"buffer":D(e)?"typed-array":U(e)?"array-buffer":Array.isArray(e)?"array":typeof e},t.getEncoding=function(e){return A(e)?"binary":C(e)?a:c},t.concatBuffers=function(...e){return i.concat(e)},t.concatArrays=function(...e){let t=[];return e.forEach((e=>t=t.concat(Array.from(e)))),new Uint8Array([...t])},t.trimLeft=function(e,t){const n=e.length-t;return n>0&&(e=e.slice(n)),e},t.trimRight=function(e,t){return e.slice(0,t)},t.calcByteLength=w,t.splitBytes=L,t.swapBytes=M,t.swapHex=function(e){return P(M(O(e)))},t.sanitizeBytes=H,t.padLeft=q,t.padRight=function(e,t,n="0"){return V(e,t,!1,n)},t.removeHexPrefix=x,t.addHexPrefix=Y,t.sanitizeHex=function(e){return(e=H(e=x(e),2))&&(e=Y(e)),e},t.removeHexLeadingZeros=function(e){const t=e.startsWith("0x");return e=(e=x(e)).startsWith(u)?e.substring(1):e,t?Y(e):e}},926:function(e,t,n){"use strict";function i(){return(null===n.g||void 0===n.g?void 0:n.g.crypto)||(null===n.g||void 0===n.g?void 0:n.g.msCrypto)||{}}function r(){const e=i();return e.subtle||e.webkitSubtle}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowserCryptoAvailable=t.getSubtleCrypto=t.getBrowerCrypto=void 0,t.getBrowerCrypto=i,t.getSubtleCrypto=r,t.isBrowserCryptoAvailable=function(){return!!i()&&!!r()}},8618:function(e,t,n){"use strict";var i=n(4155);function r(){return"undefined"===typeof document&&"undefined"!==typeof navigator&&"ReactNative"===navigator.product}function o(){return"undefined"!==typeof i&&"undefined"!==typeof i.versions&&"undefined"!==typeof i.versions.node}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=t.isReactNative=void 0,t.isReactNative=r,t.isNode=o,t.isBrowser=function(){return!r()&&!o()}},1468:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(926),t),r(n(8618),t)},9303:function(e,t,n){"use strict";n.r(t),n.d(t,{JsonRpcProvider:function(){return o},default:function(){return s}});var i=n(7187),r=n(6186);class o extends r.IJsonRpcProvider{constructor(e){super(e),this.events=new i.EventEmitter,this.connection=this.setConnection(e)}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict((0,r.formatJsonRpcRequest)(e.method,e.params||[]),t)}async requestStrict(e,t){return new Promise((async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(o){i(o)}this.events.on(`${e.id}`,(e=>{(0,r.isJsonRpcError)(e)?i(e.error.message):n(e.result)}));try{await this.connection.send(e,t)}catch(o){i(o)}}))}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),(0,r.isJsonRpcResponse)(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"===typeof e&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.connection.on("payload",(e=>this.onPayload(e))),this.connection.on("close",(()=>this.events.emit("disconnect"))),this.connection.on("error",(e=>this.events.emit("error",e))),this.events.emit("connect"))}async close(){await this.connection.close(),this.events.emit("disconnect")}}var s=o},5885:function(e,t,n){"use strict";n.r(t),n.d(t,{IEvents:function(){return s.q},IBaseJsonRpcProvider:function(){return a.jK},IJsonRpcConnection:function(){return a.XR},IJsonRpcProvider:function(){return a.x0}});var i=n(4057),r={};for(var o in i)"default"!==o&&(r[o]=function(e){return i[e]}.bind(0,o));n.d(t,r);var s=n(847),a=n(9887),c=n(1948);r={};for(var o in c)["default","IEvents","IBaseJsonRpcProvider","IJsonRpcConnection","IJsonRpcProvider"].indexOf(o)<0&&(r[o]=function(e){return c[e]}.bind(0,o));n.d(t,r)},4057:function(){},847:function(e,t,n){"use strict";n.d(t,{q:function(){return i}});class i{}},9887:function(e,t,n){"use strict";n.d(t,{XR:function(){return r},jK:function(){return o},x0:function(){return s}});var i=n(847);class r extends i.q{constructor(e){super()}}class o extends i.q{constructor(){super()}}class s extends o{constructor(e){super()}}},1948:function(){},9806:function(e,t,n){"use strict";n.d(t,{Bk:function(){return i},Ln:function(){return r},su:function(){return o},Hk:function(){return s},O4:function(){return a},CA:function(){return c},dQ:function(){return u},Z:function(){return d},xK:function(){return l}});const i="PARSE_ERROR",r="INVALID_REQUEST",o="METHOD_NOT_FOUND",s="INVALID_PARAMS",a="INTERNAL_ERROR",c="SERVER_ERROR",u=[-32700,-32600,-32601,-32602,-32603],d=[-32e3,-32099],l={[i]:{code:-32700,message:"Parse error"},[r]:{code:-32600,message:"Invalid Request"},[o]:{code:-32601,message:"Method not found"},[s]:{code:-32602,message:"Invalid params"},[a]:{code:-32603,message:"Internal error"},[c]:{code:-32e3,message:"Server error"}}},9698:function(e,t,n){"use strict";n.r(t),n.d(t,{isNodeJs:function(){return s}});var i=n(1468),r={};for(var o in i)["default","isNodeJs"].indexOf(o)<0&&(r[o]=function(e){return i[e]}.bind(0,o));n.d(t,r);const s=i.isNode},110:function(e,t,n){"use strict";n.d(t,{J_:function(){return r},i5:function(){return o},WG:function(){return s},by:function(){return a},L2:function(){return c},MI:function(){return u},CX:function(){return d}});var i=n(9806);function r(e){return e<=i.Z[0]&&e>=i.Z[1]}function o(e){return i.dQ.includes(e)}function s(e){return"number"===typeof e}function a(e){return Object.keys(i.xK).includes(e)?i.xK[e]:i.xK[i.O4]}function c(e){const t=Object.values(i.xK).find((t=>t.code===e));return t||i.xK[i.O4]}function u(e){if("undefined"===typeof e.error.code)return{valid:!1,error:"Missing code for JSON-RPC error"};if("undefined"===typeof e.error.message)return{valid:!1,error:"Missing message for JSON-RPC error"};if(!s(e.error.code))return{valid:!1,error:`Invalid error code type for JSON-RPC: ${e.error.code}`};if(o(e.error.code)){const t=c(e.error.code);if(t.message!==i.xK[i.O4].message&&e.error.message===t.message)return{valid:!1,error:`Invalid error code message for JSON-RPC: ${e.error.code}`}}return{valid:!0}}function d(e,t,n){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${t}`):e}},1937:function(e,t,n){"use strict";n.d(t,{o0:function(){return o},sT:function(){return s},tm:function(){return a},RI:function(){return c},jN:function(){return u}});var i=n(110),r=n(9806);function o(){return Date.now()*Math.pow(10,3)+Math.floor(Math.random()*Math.pow(10,3))}function s(e,t,n){return{id:n||o(),jsonrpc:"2.0",method:e,params:t}}function a(e,t){return{id:e,jsonrpc:"2.0",result:t}}function c(e,t){return{id:e,jsonrpc:"2.0",error:u(t)}}function u(e){return"undefined"===typeof e?(0,i.by)(r.O4):("string"===typeof e&&(e=Object.assign(Object.assign({},(0,i.by)(r.CA)),{message:e})),(0,i.i5)(e.code)&&(e=(0,i.L2)(e.code)),e)}},6186:function(e,t,n){"use strict";n.r(t),n.d(t,{INTERNAL_ERROR:function(){return i.O4},INVALID_PARAMS:function(){return i.Hk},INVALID_REQUEST:function(){return i.Ln},METHOD_NOT_FOUND:function(){return i.su},PARSE_ERROR:function(){return i.Bk},RESERVED_ERROR_CODES:function(){return i.dQ},SERVER_ERROR:function(){return i.CA},SERVER_ERROR_CODE_RANGE:function(){return i.Z},STANDARD_ERROR_MAP:function(){return i.xK},getError:function(){return r.by},getErrorByCode:function(){return r.L2},isReservedErrorCode:function(){return r.i5},isServerErrorCode:function(){return r.J_},isValidErrorCode:function(){return r.WG},parseConnectionError:function(){return r.CX},validateJsonRpcError:function(){return r.MI},formatErrorMessage:function(){return c.jN},formatJsonRpcError:function(){return c.RI},formatJsonRpcRequest:function(){return c.sT},formatJsonRpcResult:function(){return c.tm},payloadId:function(){return c.o0},isValidDefaultRoute:function(){return u.mm},isValidLeadingWildcardRoute:function(){return u.EZ},isValidRoute:function(){return u.OF},isValidTrailingWildcardRoute:function(){return u.$Z},isValidWildcardRoute:function(){return u.e3},isHttpUrl:function(){return l.jK},isLocalhostUrl:function(){return l.JF},isWsUrl:function(){return l.UZ},isJsonRpcError:function(){return f.jg},isJsonRpcPayload:function(){return f.fi},isJsonRpcRequest:function(){return f.DW},isJsonRpcResponse:function(){return f.u},isJsonRpcResult:function(){return f.k4},isJsonRpcValidationInvalid:function(){return f.V3}});var i=n(9806),r=n(110),o=n(9698),s={};for(var a in o)["default","INTERNAL_ERROR","INVALID_PARAMS","INVALID_REQUEST","METHOD_NOT_FOUND","PARSE_ERROR","RESERVED_ERROR_CODES","SERVER_ERROR","SERVER_ERROR_CODE_RANGE","STANDARD_ERROR_MAP","getError","getErrorByCode","isReservedErrorCode","isServerErrorCode","isValidErrorCode","parseConnectionError","validateJsonRpcError"].indexOf(a)<0&&(s[a]=function(e){return o[e]}.bind(0,a));n.d(t,s);var c=n(1937),u=n(2326),d=n(6043);s={};for(var a in d)["default","INTERNAL_ERROR","INVALID_PARAMS","INVALID_REQUEST","METHOD_NOT_FOUND","PARSE_ERROR","RESERVED_ERROR_CODES","SERVER_ERROR","SERVER_ERROR_CODE_RANGE","STANDARD_ERROR_MAP","getError","getErrorByCode","isReservedErrorCode","isServerErrorCode","isValidErrorCode","parseConnectionError","validateJsonRpcError","isNodeJs","formatErrorMessage","formatJsonRpcError","formatJsonRpcRequest","formatJsonRpcResult","payloadId","isValidDefaultRoute","isValidLeadingWildcardRoute","isValidRoute","isValidTrailingWildcardRoute","isValidWildcardRoute"].indexOf(a)<0&&(s[a]=function(e){return d[e]}.bind(0,a));n.d(t,s);var l=n(6119),f=n(4733)},2326:function(e,t,n){"use strict";function i(e){return e.includes("*")?o(e):!/\W/g.test(e)}function r(e){return"*"===e}function o(e){return!!r(e)||!!e.includes("*")&&(2===e.split("*").length&&1===e.split("*").filter((e=>""===e.trim())).length)}function s(e){return!r(e)&&o(e)&&!e.split("*")[0].trim()}function a(e){return!r(e)&&o(e)&&!e.split("*")[1].trim()}n.d(t,{OF:function(){return i},mm:function(){return r},e3:function(){return o},EZ:function(){return s},$Z:function(){return a}})},6043:function(e,t,n){"use strict";n.r(t);var i=n(5885),r={};for(var o in i)"default"!==o&&(r[o]=function(e){return i[e]}.bind(0,o));n.d(t,r)},6119:function(e,t,n){"use strict";n.d(t,{jK:function(){return r},UZ:function(){return o},JF:function(){return s}});function i(e,t){const n=function(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return"undefined"!==typeof n&&new RegExp(t).test(n)}function r(e){return i(e,"^https?:")}function o(e){return i(e,"^wss?:")}function s(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}},4733:function(e,t,n){"use strict";function i(e){return"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function r(e){return i(e)&&"method"in e}function o(e){return i(e)&&(s(e)||a(e))}function s(e){return"result"in e}function a(e){return"error"in e}function c(e){return"error"in e&&!1===e.valid}n.d(t,{fi:function(){return i},DW:function(){return r},u:function(){return o},k4:function(){return s},jg:function(){return a},V3:function(){return c}})},9855:function(e,t,n){"use strict";n.r(t),n.d(t,{WsConnection:function(){return a},default:function(){return c}});var i=n(7187),r=n(1055),o=n(6186);const s="undefined"!==typeof n.g.WebSocket?n.g.WebSocket:n(2030);class a{constructor(e){if(this.url=e,this.events=new i.EventEmitter,this.registering=!1,!(0,o.isWsUrl)(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return"undefined"!==typeof this.socket}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if("undefined"===typeof this.socket)throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(e,t){"undefined"===typeof this.socket&&(this.socket=await this.register());try{this.socket.send((0,r.safeJsonStringify)(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!(0,o.isWsUrl)(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);return this.registering?new Promise(((e,t)=>{this.events.once("register_error",(e=>{t(e)})),this.events.once("open",(()=>{if("undefined"===typeof this.socket)return t(new Error("WebSocket connection is missing or invalid"));e(this.socket)}))})):(this.url=e,this.registering=!0,new Promise(((t,n)=>{const i=(0,o.isReactNative)()?void 0:{rejectUnauthorized:!(0,o.isLocalhostUrl)(e)},r=new s(e,[],i);r.onopen=()=>{this.onOpen(r),t(r)},r.onerror=e=>{const t=this.parseError(e.error);this.events.emit("register_error",t),this.onClose(),n(t)}})))}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=()=>this.onClose(),e.onerror=e=>{const t=this.parseError(e.error);this.events.emit("error",t)},this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if("undefined"===typeof e.data)return;const t="string"===typeof e.data?(0,r.safeJsonParse)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const n=this.parseError(t),i=n.message||n.toString(),r=(0,o.formatJsonRpcError)(e,i);this.events.emit("payload",r)}parseError(e,t=this.url){return(0,o.parseConnectionError)(e,t,"WS")}}var c=a},2030:function(e){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},5727:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PINO_CUSTOM_CONTEXT_KEY=t.PINO_LOGGER_DEFAULTS=void 0,t.PINO_LOGGER_DEFAULTS={level:"info",prettyPrint:{colorize:!0,translateTime:"SYS:standard",ignore:"pid,hostname"}},t.PINO_CUSTOM_CONTEXT_KEY="custom_context"},9107:function(e,t,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),r(n(5727),t),r(n(8048),t)},8048:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateChildLogger=t.formatChildLoggerContext=t.getLoggerContext=t.setBrowserLoggerContext=t.getBrowserLoggerContext=t.getDefaultLoggerOptions=void 0;const i=n(5727);function r(e,t=i.PINO_CUSTOM_CONTEXT_KEY){return e[t]||""}function o(e,t,n=i.PINO_CUSTOM_CONTEXT_KEY){return e[n]=t,e}function s(e,t=i.PINO_CUSTOM_CONTEXT_KEY){let n="";return n="undefined"===typeof e.bindings?r(e,t):e.bindings().context||"",n}function a(e,t,n=i.PINO_CUSTOM_CONTEXT_KEY){const r=s(e,n);return r.trim()?`${r}/${t}`:t}t.getDefaultLoggerOptions=function(e){return Object.assign(Object.assign({},e),{level:(null===e||void 0===e?void 0:e.level)||i.PINO_LOGGER_DEFAULTS.level,prettyPrint:(null===e||void 0===e?void 0:e.prettyPrint)||i.PINO_LOGGER_DEFAULTS.prettyPrint})},t.getBrowserLoggerContext=r,t.setBrowserLoggerContext=o,t.getLoggerContext=s,t.formatChildLoggerContext=a,t.generateChildLogger=function(e,t,n=i.PINO_CUSTOM_CONTEXT_KEY){const r=a(e,t,n);return o(e.child({context:r}),r,n)}},8009:function(e,t,n){"use strict";n.r(t),n.d(t,{parsePublishRequest:function(){return s.kM},parseSubscribeRequest:function(){return s.tT},parseSubscriptionRequest:function(){return s.LW},parseUnsubscribeRequest:function(){return s.e5},RELAY_JSONRPC:function(){return a.i},isPublishMethod:function(){return c.tO},isPublishParams:function(){return c.xx},isPublishRequest:function(){return c.QY},isSubscribeMethod:function(){return c.z9},isSubscribeParams:function(){return c.Z6},isSubscribeRequest:function(){return c.PJ},isSubscriptionMethod:function(){return c.Hr},isSubscriptionParams:function(){return c.aH},isSubscriptionRequest:function(){return c.cW},isUnsubscribeMethod:function(){return c.hq},isUnsubscribeParams:function(){return c.Me},isUnsubscribeRequest:function(){return c.eT}});var i=n(1882),r={};for(var o in i)"default"!==o&&(r[o]=function(e){return i[e]}.bind(0,o));n.d(t,r);var s=n(3821),a=n(8183),c=n(7821)},8183:function(e,t,n){"use strict";n.d(t,{i:function(){return i}});const i={waku:{info:"waku_info",connect:"waku_connect",disconnect:"waku_disconnect",publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"}}},5152:function(e,t,n){"use strict";function i(e,t,n="string"){if(!e[t]||typeof e[t]!==n)throw new Error(`Missing or invalid "${t}" param`)}function r(e,t,n){return!!(!n.length?function(e,t){return Array.isArray(e)?e.length===t:Object.keys(e).length===t}(e,t.length):function(e,t){return Array.isArray(e)?e.length>=t:Object.keys(e).length>=t}(e,t.length))&&function(e,t){let n=!0;return t.forEach((t=>{t in e||(n=!1)})),n}(e,t)}function o(e,t,n="_"){const i=e.split(n);return i[i.length-1].trim().toLowerCase()===t.trim().toLowerCase()}n.d(t,{p_:function(){return i},p3:function(){return r},C1:function(){return o}})},3821:function(e,t,n){"use strict";n.d(t,{tT:function(){return o},kM:function(){return s},e5:function(){return a},LW:function(){return c}});var i=n(5152),r=n(7821);function o(e){if(!(0,r.z9)(e.method))throw new Error("JSON-RPC Request has invalid subscribe method");if(!(0,r.Z6)(e.params))throw new Error("JSON-RPC Request has invalid subscribe params");const t=e.params;return(0,i.p_)(t,"topic"),t}function s(e){if(!(0,r.tO)(e.method))throw new Error("JSON-RPC Request has invalid publish method");if(!(0,r.xx)(e.params))throw new Error("JSON-RPC Request has invalid publish params");const t=e.params;return(0,i.p_)(t,"topic"),(0,i.p_)(t,"message"),(0,i.p_)(t,"ttl","number"),t}function a(e){if(!(0,r.hq)(e.method))throw new Error("JSON-RPC Request has invalid unsubscribe method");if(!(0,r.Me)(e.params))throw new Error("JSON-RPC Request has invalid unsubscribe params");const t=e.params;return(0,i.p_)(t,"id"),t}function c(e){if(!(0,r.Hr)(e.method))throw new Error("JSON-RPC Request has invalid subscription method");if(!(0,r.aH)(e.params))throw new Error("JSON-RPC Request has invalid subscription params");const t=e.params;return(0,i.p_)(t,"id"),(0,i.p_)(t,"data"),t}},1882:function(){},7821:function(e,t,n){"use strict";n.d(t,{PJ:function(){return r},z9:function(){return o},Z6:function(){return s},QY:function(){return a},tO:function(){return c},xx:function(){return u},eT:function(){return d},hq:function(){return l},Me:function(){return f},cW:function(){return E},Hr:function(){return h},aH:function(){return p}});var i=n(5152);function r(e){return o(e.method)&&s(e.params)}function o(e){return(0,i.C1)(e,"subscribe")}function s(e){return(0,i.p3)(e,["topic"],[])}function a(e){return c(e.method)&&u(e.params)}function c(e){return(0,i.C1)(e,"publish")}function u(e){return(0,i.p3)(e,["message","topic","ttl"],["prompt"])}function d(e){return l(e.method)&&f(e.params)}function l(e){return(0,i.C1)(e,"unsubscribe")}function f(e){return(0,i.p3)(e,["id","topic"],[])}function E(e){return h(e.method)&&p(e.params)}function h(e){return(0,i.C1)(e,"subscription")}function p(e){return(0,i.p3)(e,["id","data"],[])}},1055:function(e,t,n){"use strict";function i(e){if("string"!==typeof e)throw new Error("Cannot safe json parse value of type "+typeof e);try{return JSON.parse(e)}catch(t){return e}}function r(e){return"string"===typeof e?e:JSON.stringify(e)}n.r(t),n.d(t,{safeJsonParse:function(){return i},safeJsonStringify:function(){return r}})},6101:function(e,t,n){"use strict";n.d(t,{U:function(){return r}});var i=n(847);class r extends i.q{constructor(e){super(),this.protocol="wc",this.version=2}}},7067:function(e,t,n){"use strict";n.d(t,{J:function(){return i},Q:function(){return r}});class i{}class r{constructor(e,t){this.client=e,this.keychain=t}}},632:function(e,t,n){"use strict";n.d(t,{W:function(){return i}});class i{constructor(e){this.sequence=e}}},1976:function(e,t,n){"use strict";n.d(t,{y:function(){return r}});var i=n(847);class r extends i.q{constructor(e,t){super(),this.client=e,this.logger=t,this.records=new Map}}},3609:function(e,t,n){"use strict";n.r(t),n.d(t,{IClient:function(){return i.U},IPairing:function(){return r.s},ICrypto:function(){return o.Q},IKeyChain:function(){return o.J},IEngine:function(){return s.W},IJsonRpcHistory:function(){return a.y},IRelayer:function(){return l.o},ISequence:function(){return f.P},ISession:function(){return E.V},ISubscription:function(){return h.c}});var i=n(6101),r=n(4088),o=n(7067),s=n(632),a=n(1976),c=n(4199),u={};for(var d in c)["default","IClient","IPairing","ICrypto","IKeyChain","IEngine","IJsonRpcHistory"].indexOf(d)<0&&(u[d]=function(e){return c[e]}.bind(0,d));n.d(t,u);var l=n(4830),f=n(1462),E=n(9672),h=n(317)},4199:function(){},4088:function(e,t,n){"use strict";n.d(t,{s:function(){return r}});var i=n(1462);class r extends i.P{}},4830:function(e,t,n){"use strict";n.d(t,{o:function(){return r}});var i=n(847);class r extends i.q{constructor(e,t,n){super(),this.client=e,this.logger=t}}},1462:function(e,t,n){"use strict";n.d(t,{P:function(){return r}});var i=n(847);class r extends i.q{constructor(e,t){super(),this.client=e,this.logger=t}}},9672:function(e,t,n){"use strict";n.d(t,{V:function(){return r}});var i=n(1462);class r extends i.P{}},317:function(e,t,n){"use strict";n.d(t,{c:function(){return r}});var i=n(847);class r extends i.q{constructor(e,t,n){super(),this.client=e,this.logger=t,this.context=n,this.subscriptions=new Map}}},8394:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ERROR=t.ERROR_TYPE=void 0;const i=n(2182);t.ERROR_TYPE=i.enumify({GENERIC:"GENERIC",MISSING_OR_INVALID:"MISSING_OR_INVALID",MISSING_RESPONSE:"MISSING_RESPONSE",MISSING_DECRYPT_PARAMS:"MISSING_DECRYPT_PARAMS",INVALID_UPDATE_REQUEST:"INVALID_UPDATE_REQUEST",INVALID_UPGRADE_REQUEST:"INVALID_UPGRADE_REQUEST",RECORD_ALREADY_EXISTS:"RECORD_ALREADY_EXISTS",RESTORE_WILL_OVERRIDE:"RESTORE_WILL_OVERRIDE",NO_MATCHING_ID:"NO_MATCHING_ID",NO_MATCHING_TOPIC:"NO_MATCHING_TOPIC",NO_MATCHING_RESPONSE:"NO_MATCHING_RESPONSE",NO_MATCHING_KEY:"NO_MATCHING_KEY",UNKNOWN_JSONRPC_METHOD:"UNKNOWN_JSONRPC_METHOD",MISMATCHED_TOPIC:"MISMATCHED_TOPIC",MISMATCHED_ACCOUNTS:"MISMATCHED_ACCOUNTS",SETTLED:"SETTLED",NOT_APPROVED:"NOT_APPROVED",PROPOSAL_RESPONDED:"PROPOSAL_RESPONDED",RESPONSE_ACKNOWLEDGED:"RESPONSE_ACKNOWLEDGED",EXPIRED:"EXPIRED",SETTLE_TIMEOUT:"SETTLE_TIMEOUT",JSONRPC_REQUEST_TIMEOUT:"JSONRPC_REQUEST_TIMEOUT",UNAUTHORIZED_TARGET_CHAIN:"UNAUTHORIZED_TARGET_CHAIN",UNAUTHORIZED_JSON_RPC_METHOD:"UNAUTHORIZED_JSON_RPC_METHOD",UNAUTHORIZED_NOTIFICATION_TYPE:"UNAUTHORIZED_NOTIFICATION_TYPE",UNAUTHORIZED_UPDATE_REQUEST:"UNAUTHORIZED_UPDATE_REQUEST",UNAUTHORIZED_UPGRADE_REQUEST:"UNAUTHORIZED_UPGRADE_REQUEST",UNAUTHORIZED_MATCHING_CONTROLLER:"UNAUTHORIZED_MATCHING_CONTROLLER",JSONRPC_REQUEST_METHOD_REJECTED:"JSONRPC_REQUEST_METHOD_REJECTED",JSONRPC_REQUEST_METHOD_UNAUTHORIZED:"JSONRPC_REQUEST_METHOD_UNAUTHORIZED",JSONRPC_REQUEST_METHOD_UNSUPPORTED:"JSONRPC_REQUEST_METHOD_UNSUPPORTED",DISCONNECTED_ALL_CHAINS:"DISCONNECTED_ALL_CHAINS",DISCONNECTED_TARGET_CHAIN:"DISCONNECTED_TARGET_CHAIN",DISAPPROVED_CHAINS:"DISAPPROVED_CHAINS",DISAPPROVED_JSONRPC:"DISAPPROVED_JSONRPC",DISAPPROVED_NOTIFICATION:"DISAPPROVED_NOTIFICATION",UNSUPPORTED_CHAINS:"UNSUPPORTED_CHAINS",UNSUPPORTED_JSONRPC:"UNSUPPORTED_JSONRPC",UNSUPPORTED_NOTIFICATION:"UNSUPPORTED_NOTIFICATION",UNSUPPORTED_SIGNAL:"UNSUPPORTED_SIGNAL",USER_DISCONNECTED:"USER_DISCONNECTED",UNKNOWN:"UNKNOWN"});const r="Something went wrong",o="parameter",s="session",a="Ethereum";t.ERROR={[t.ERROR_TYPE.GENERIC]:{type:t.ERROR_TYPE.GENERIC,code:0,stringify:e=>(null===e||void 0===e?void 0:e.message)||r,format:e=>({code:t.ERROR[t.ERROR_TYPE.GENERIC].code,message:t.ERROR[t.ERROR_TYPE.GENERIC].stringify(e)})},[t.ERROR_TYPE.MISSING_OR_INVALID]:{type:t.ERROR_TYPE.MISSING_OR_INVALID,code:1e3,stringify:e=>`Missing or invalid ${(null===e||void 0===e?void 0:e.name)||o}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.MISSING_OR_INVALID].code,message:t.ERROR[t.ERROR_TYPE.MISSING_OR_INVALID].stringify(e)})},[t.ERROR_TYPE.MISSING_RESPONSE]:{type:t.ERROR_TYPE.MISSING_RESPONSE,code:1001,stringify:e=>`Response is required for approved ${(null===e||void 0===e?void 0:e.context)||s} proposals`,format:e=>({code:t.ERROR[t.ERROR_TYPE.MISSING_RESPONSE].code,message:t.ERROR[t.ERROR_TYPE.MISSING_RESPONSE].stringify(e)})},[t.ERROR_TYPE.MISSING_DECRYPT_PARAMS]:{type:t.ERROR_TYPE.MISSING_DECRYPT_PARAMS,code:1002,stringify:e=>`Decrypt params required for ${(null===e||void 0===e?void 0:e.context)||s}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.MISSING_DECRYPT_PARAMS].code,message:t.ERROR[t.ERROR_TYPE.MISSING_DECRYPT_PARAMS].stringify(e)})},[t.ERROR_TYPE.INVALID_UPDATE_REQUEST]:{type:t.ERROR_TYPE.INVALID_UPDATE_REQUEST,code:1003,stringify:e=>`Invalid ${(null===e||void 0===e?void 0:e.context)||s} update request`,format:e=>({code:t.ERROR[t.ERROR_TYPE.INVALID_UPDATE_REQUEST].code,message:t.ERROR[t.ERROR_TYPE.INVALID_UPDATE_REQUEST].stringify(e)})},[t.ERROR_TYPE.INVALID_UPGRADE_REQUEST]:{type:t.ERROR_TYPE.INVALID_UPGRADE_REQUEST,code:1004,stringify:e=>`Invalid ${(null===e||void 0===e?void 0:e.context)||s} upgrade request`,format:e=>({code:t.ERROR[t.ERROR_TYPE.INVALID_UPGRADE_REQUEST].code,message:t.ERROR[t.ERROR_TYPE.INVALID_UPGRADE_REQUEST].stringify(e)})},[t.ERROR_TYPE.RECORD_ALREADY_EXISTS]:{type:t.ERROR_TYPE.RECORD_ALREADY_EXISTS,code:1100,stringify:e=>`Record already exists for ${(null===e||void 0===e?void 0:e.context)||s} matching id: ${null===e||void 0===e?void 0:e.id}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.RECORD_ALREADY_EXISTS].code,message:t.ERROR[t.ERROR_TYPE.RECORD_ALREADY_EXISTS].stringify(e)})},[t.ERROR_TYPE.RESTORE_WILL_OVERRIDE]:{type:t.ERROR_TYPE.RESTORE_WILL_OVERRIDE,code:1200,stringify:e=>`Restore will override already set ${(null===e||void 0===e?void 0:e.context)||s}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.RESTORE_WILL_OVERRIDE].code,message:t.ERROR[t.ERROR_TYPE.RESTORE_WILL_OVERRIDE].stringify(e)})},[t.ERROR_TYPE.NO_MATCHING_ID]:{type:t.ERROR_TYPE.NO_MATCHING_ID,code:1300,stringify:e=>`No matching ${(null===e||void 0===e?void 0:e.context)||s} with id: ${null===e||void 0===e?void 0:e.id}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.NO_MATCHING_ID].code,message:t.ERROR[t.ERROR_TYPE.NO_MATCHING_ID].stringify(e)})},[t.ERROR_TYPE.NO_MATCHING_TOPIC]:{type:t.ERROR_TYPE.NO_MATCHING_TOPIC,code:1301,stringify:e=>`No matching ${(null===e||void 0===e?void 0:e.context)||s} with topic: ${null===e||void 0===e?void 0:e.topic}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.NO_MATCHING_TOPIC].code,message:t.ERROR[t.ERROR_TYPE.NO_MATCHING_TOPIC].stringify(e)})},[t.ERROR_TYPE.NO_MATCHING_RESPONSE]:{type:t.ERROR_TYPE.NO_MATCHING_RESPONSE,code:1302,stringify:e=>`No response found in pending ${(null===e||void 0===e?void 0:e.context)||s} proposal`,format:e=>({code:t.ERROR[t.ERROR_TYPE.NO_MATCHING_RESPONSE].code,message:t.ERROR[t.ERROR_TYPE.NO_MATCHING_RESPONSE].stringify(e)})},[t.ERROR_TYPE.NO_MATCHING_KEY]:{type:t.ERROR_TYPE.NO_MATCHING_KEY,code:1303,stringify:e=>`No matching key with tag: ${null===e||void 0===e?void 0:e.tag}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.NO_MATCHING_KEY].code,message:t.ERROR[t.ERROR_TYPE.NO_MATCHING_KEY].stringify(e)})},[t.ERROR_TYPE.UNKNOWN_JSONRPC_METHOD]:{type:t.ERROR_TYPE.UNKNOWN_JSONRPC_METHOD,code:1400,stringify:e=>`Unknown JSON-RPC Method Requested: ${null===e||void 0===e?void 0:e.method}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.UNKNOWN_JSONRPC_METHOD].code,message:t.ERROR[t.ERROR_TYPE.UNKNOWN_JSONRPC_METHOD].stringify(e)})},[t.ERROR_TYPE.MISMATCHED_TOPIC]:{type:t.ERROR_TYPE.MISMATCHED_TOPIC,code:1500,stringify:e=>`Mismatched topic for ${(null===e||void 0===e?void 0:e.context)||s} with id: ${null===e||void 0===e?void 0:e.id}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.MISMATCHED_TOPIC].code,message:t.ERROR[t.ERROR_TYPE.MISMATCHED_TOPIC].stringify(e)})},[t.ERROR_TYPE.MISMATCHED_ACCOUNTS]:{type:t.ERROR_TYPE.MISMATCHED_ACCOUNTS,code:1501,stringify:e=>`Invalid accounts with mismatched chains: ${null===e||void 0===e?void 0:e.mismatched.toString()}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.MISMATCHED_ACCOUNTS].code,message:t.ERROR[t.ERROR_TYPE.MISMATCHED_ACCOUNTS].stringify(e)})},[t.ERROR_TYPE.SETTLED]:{type:t.ERROR_TYPE.SETTLED,code:1600,stringify:e=>`${i.capitalize((null===e||void 0===e?void 0:e.context)||s)} settled`,format:e=>({code:t.ERROR[t.ERROR_TYPE.SETTLED].code,message:t.ERROR[t.ERROR_TYPE.SETTLED].stringify(e)})},[t.ERROR_TYPE.NOT_APPROVED]:{type:t.ERROR_TYPE.NOT_APPROVED,code:1601,stringify:e=>`${i.capitalize((null===e||void 0===e?void 0:e.context)||s)} not approved`,format:e=>({code:t.ERROR[t.ERROR_TYPE.NOT_APPROVED].code,message:t.ERROR[t.ERROR_TYPE.NOT_APPROVED].stringify(e)})},[t.ERROR_TYPE.PROPOSAL_RESPONDED]:{type:t.ERROR_TYPE.PROPOSAL_RESPONDED,code:1602,stringify:e=>`${i.capitalize((null===e||void 0===e?void 0:e.context)||s)} proposal responded`,format:e=>({code:t.ERROR[t.ERROR_TYPE.PROPOSAL_RESPONDED].code,message:t.ERROR[t.ERROR_TYPE.PROPOSAL_RESPONDED].stringify(e)})},[t.ERROR_TYPE.RESPONSE_ACKNOWLEDGED]:{type:t.ERROR_TYPE.RESPONSE_ACKNOWLEDGED,code:1603,stringify:e=>`${i.capitalize((null===e||void 0===e?void 0:e.context)||s)} response acknowledge`,format:e=>({code:t.ERROR[t.ERROR_TYPE.RESPONSE_ACKNOWLEDGED].code,message:t.ERROR[t.ERROR_TYPE.RESPONSE_ACKNOWLEDGED].stringify(e)})},[t.ERROR_TYPE.EXPIRED]:{type:t.ERROR_TYPE.EXPIRED,code:1603,stringify:e=>`${i.capitalize((null===e||void 0===e?void 0:e.context)||s)} expired`,format:e=>({code:t.ERROR[t.ERROR_TYPE.EXPIRED].code,message:t.ERROR[t.ERROR_TYPE.EXPIRED].stringify(e)})},[t.ERROR_TYPE.SETTLE_TIMEOUT]:{type:t.ERROR_TYPE.SETTLE_TIMEOUT,code:2e3,stringify:e=>`${i.capitalize((null===e||void 0===e?void 0:e.context)||s)} failed to settle after ${(null===e||void 0===e?void 0:e.timeout)/1e3} seconds`,format:e=>({code:t.ERROR[t.ERROR_TYPE.SETTLE_TIMEOUT].code,message:t.ERROR[t.ERROR_TYPE.SETTLE_TIMEOUT].stringify(e)})},[t.ERROR_TYPE.JSONRPC_REQUEST_TIMEOUT]:{type:t.ERROR_TYPE.JSONRPC_REQUEST_TIMEOUT,code:2001,stringify:e=>`JSON-RPC Request timeout after ${(null===e||void 0===e?void 0:e.timeout)/1e3} seconds: ${null===e||void 0===e?void 0:e.method}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.JSONRPC_REQUEST_TIMEOUT].code,message:t.ERROR[t.ERROR_TYPE.JSONRPC_REQUEST_TIMEOUT].stringify(e)})},[t.ERROR_TYPE.UNAUTHORIZED_TARGET_CHAIN]:{type:t.ERROR_TYPE.UNAUTHORIZED_TARGET_CHAIN,code:3e3,stringify:e=>`Unauthorized Target ChainId Requested: ${null===e||void 0===e?void 0:e.chainId}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.UNAUTHORIZED_TARGET_CHAIN].code,message:t.ERROR[t.ERROR_TYPE.UNAUTHORIZED_TARGET_CHAIN].stringify(e)})},[t.ERROR_TYPE.UNAUTHORIZED_JSON_RPC_METHOD]:{type:t.ERROR_TYPE.UNAUTHORIZED_JSON_RPC_METHOD,code:3001,stringify:e=>`Unauthorized JSON-RPC Method Requested: ${null===e||void 0===e?void 0:e.method}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.UNAUTHORIZED_JSON_RPC_METHOD].code,message:t.ERROR[t.ERROR_TYPE.UNAUTHORIZED_JSON_RPC_METHOD].stringify(e)})},[t.ERROR_TYPE.UNAUTHORIZED_NOTIFICATION_TYPE]:{type:t.ERROR_TYPE.UNAUTHORIZED_NOTIFICATION_TYPE,code:3002,stringify:e=>`Unauthorized Notification Type Requested: ${null===e||void 0===e?void 0:e.type}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.UNAUTHORIZED_NOTIFICATION_TYPE].code,message:t.ERROR[t.ERROR_TYPE.UNAUTHORIZED_NOTIFICATION_TYPE].stringify(e)})},[t.ERROR_TYPE.UNAUTHORIZED_UPDATE_REQUEST]:{type:t.ERROR_TYPE.UNAUTHORIZED_UPDATE_REQUEST,code:3003,stringify:e=>`Unauthorized ${(null===e||void 0===e?void 0:e.context)||s} update request`,format:e=>({code:t.ERROR[t.ERROR_TYPE.UNAUTHORIZED_UPDATE_REQUEST].code,message:t.ERROR[t.ERROR_TYPE.UNAUTHORIZED_UPDATE_REQUEST].stringify(e)})},[t.ERROR_TYPE.UNAUTHORIZED_UPGRADE_REQUEST]:{type:t.ERROR_TYPE.UNAUTHORIZED_UPGRADE_REQUEST,code:3004,stringify:e=>`Unauthorized ${(null===e||void 0===e?void 0:e.context)||s} upgrade request`,format:e=>({code:t.ERROR[t.ERROR_TYPE.UNAUTHORIZED_UPGRADE_REQUEST].code,message:t.ERROR[t.ERROR_TYPE.UNAUTHORIZED_UPGRADE_REQUEST].stringify(e)})},[t.ERROR_TYPE.UNAUTHORIZED_MATCHING_CONTROLLER]:{type:t.ERROR_TYPE.UNAUTHORIZED_MATCHING_CONTROLLER,code:3005,stringify:e=>`Unauthorized: peer is also ${(null===e||void 0===e?void 0:e.controller)?"":"not "}controller`,format:e=>({code:t.ERROR[t.ERROR_TYPE.UNAUTHORIZED_MATCHING_CONTROLLER].code,message:t.ERROR[t.ERROR_TYPE.UNAUTHORIZED_MATCHING_CONTROLLER].stringify(e)})},[t.ERROR_TYPE.JSONRPC_REQUEST_METHOD_REJECTED]:{type:t.ERROR_TYPE.JSONRPC_REQUEST_METHOD_REJECTED,code:4001,stringify:e=>"User rejected the request.",format:e=>({code:t.ERROR[t.ERROR_TYPE.JSONRPC_REQUEST_METHOD_REJECTED].code,message:t.ERROR[t.ERROR_TYPE.JSONRPC_REQUEST_METHOD_REJECTED].stringify(e)})},[t.ERROR_TYPE.JSONRPC_REQUEST_METHOD_UNAUTHORIZED]:{type:t.ERROR_TYPE.JSONRPC_REQUEST_METHOD_UNAUTHORIZED,code:4100,stringify:e=>"The requested account and/or method has not been authorized by the user.",format:e=>({code:t.ERROR[t.ERROR_TYPE.JSONRPC_REQUEST_METHOD_UNAUTHORIZED].code,message:t.ERROR[t.ERROR_TYPE.JSONRPC_REQUEST_METHOD_UNAUTHORIZED].stringify(e)})},[t.ERROR_TYPE.JSONRPC_REQUEST_METHOD_UNSUPPORTED]:{type:t.ERROR_TYPE.JSONRPC_REQUEST_METHOD_UNSUPPORTED,code:4200,stringify:e=>`The requested method is not supported by this ${(null===e||void 0===e?void 0:e.blockhain)||a} provider.`,format:e=>({code:t.ERROR[t.ERROR_TYPE.JSONRPC_REQUEST_METHOD_UNSUPPORTED].code,message:t.ERROR[t.ERROR_TYPE.JSONRPC_REQUEST_METHOD_UNSUPPORTED].stringify(e)})},[t.ERROR_TYPE.DISCONNECTED_ALL_CHAINS]:{type:t.ERROR_TYPE.DISCONNECTED_ALL_CHAINS,code:4900,stringify:e=>"The provider is disconnected from all chains.",format:e=>({code:t.ERROR[t.ERROR_TYPE.DISCONNECTED_ALL_CHAINS].code,message:t.ERROR[t.ERROR_TYPE.DISCONNECTED_ALL_CHAINS].stringify(e)})},[t.ERROR_TYPE.DISCONNECTED_TARGET_CHAIN]:{type:t.ERROR_TYPE.DISCONNECTED_TARGET_CHAIN,code:4901,stringify:e=>"The provider is disconnected from the specified chain.",format:e=>({code:t.ERROR[t.ERROR_TYPE.DISCONNECTED_TARGET_CHAIN].code,message:t.ERROR[t.ERROR_TYPE.DISCONNECTED_TARGET_CHAIN].stringify(e)})},[t.ERROR_TYPE.DISAPPROVED_CHAINS]:{type:t.ERROR_TYPE.DISAPPROVED_CHAINS,code:5e3,stringify:e=>"User disapproved requested chains",format:e=>({code:t.ERROR[t.ERROR_TYPE.DISAPPROVED_CHAINS].code,message:t.ERROR[t.ERROR_TYPE.DISAPPROVED_CHAINS].stringify(e)})},[t.ERROR_TYPE.DISAPPROVED_JSONRPC]:{type:t.ERROR_TYPE.DISAPPROVED_JSONRPC,code:5001,stringify:e=>"User disapproved requested json-rpc methods",format:e=>({code:t.ERROR[t.ERROR_TYPE.DISAPPROVED_JSONRPC].code,message:t.ERROR[t.ERROR_TYPE.DISAPPROVED_JSONRPC].stringify(e)})},[t.ERROR_TYPE.DISAPPROVED_NOTIFICATION]:{type:t.ERROR_TYPE.DISAPPROVED_NOTIFICATION,code:5002,stringify:e=>"User disapproved requested notification types",format:e=>({code:t.ERROR[t.ERROR_TYPE.DISAPPROVED_NOTIFICATION].code,message:t.ERROR[t.ERROR_TYPE.DISAPPROVED_NOTIFICATION].stringify(e)})},[t.ERROR_TYPE.UNSUPPORTED_CHAINS]:{type:t.ERROR_TYPE.UNSUPPORTED_CHAINS,code:5100,stringify:e=>`Requested chains are not supported: ${null===e||void 0===e?void 0:e.chains.toString()}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.UNSUPPORTED_CHAINS].code,message:t.ERROR[t.ERROR_TYPE.UNSUPPORTED_CHAINS].stringify(e)})},[t.ERROR_TYPE.UNSUPPORTED_JSONRPC]:{type:t.ERROR_TYPE.UNSUPPORTED_JSONRPC,code:5101,stringify:e=>`Requested json-rpc methods are not supported: ${null===e||void 0===e?void 0:e.methods.toString()}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.UNSUPPORTED_JSONRPC].code,message:t.ERROR[t.ERROR_TYPE.UNSUPPORTED_JSONRPC].stringify(e)})},[t.ERROR_TYPE.UNSUPPORTED_NOTIFICATION]:{type:t.ERROR_TYPE.UNSUPPORTED_NOTIFICATION,code:5102,stringify:e=>`Requested notification types are not supported: ${null===e||void 0===e?void 0:e.types.toString()}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.UNSUPPORTED_NOTIFICATION].code,message:t.ERROR[t.ERROR_TYPE.UNSUPPORTED_NOTIFICATION].stringify(e)})},[t.ERROR_TYPE.UNSUPPORTED_SIGNAL]:{type:t.ERROR_TYPE.UNSUPPORTED_SIGNAL,code:5103,stringify:e=>`Proposed ${(null===e||void 0===e?void 0:e.context)||s} signal is unsupported`,format:e=>({code:t.ERROR[t.ERROR_TYPE.UNSUPPORTED_SIGNAL].code,message:t.ERROR[t.ERROR_TYPE.UNSUPPORTED_SIGNAL].stringify(e)})},[t.ERROR_TYPE.USER_DISCONNECTED]:{type:t.ERROR_TYPE.USER_DISCONNECTED,code:5900,stringify:e=>`User disconnected ${(null===e||void 0===e?void 0:e.context)||s}`,format:e=>({code:t.ERROR[t.ERROR_TYPE.USER_DISCONNECTED].code,message:t.ERROR[t.ERROR_TYPE.USER_DISCONNECTED].stringify(e)})},[t.ERROR_TYPE.UNKNOWN]:{type:t.ERROR_TYPE.UNKNOWN,code:9e3,stringify:e=>"Unknown error"+(e?`: ${null===e||void 0===e?void 0:e.toString()}`:""),format:e=>({code:t.ERROR[t.ERROR_TYPE.UNKNOWN].code,message:t.ERROR[t.ERROR_TYPE.UNKNOWN].stringify(e)})}}},2182:function(e,t,n){"use strict";var i=n(4155);Object.defineProperty(t,"__esModule",{value:!0}),t.capitalize=t.capitalizeWord=t.enumify=t.mapEntries=t.objToMap=t.mapToObj=t.hasOverlap=t.assertType=t.formatRelayRpcUrl=t.getRelayClientMetadata=t.getAppMetadata=t.appendToQueryString=t.getEnvironment=t.isBrowser=t.isReactNative=t.isNode=void 0;const r=n(655).__importStar(n(7563)),o=n(5755),s=n(2873);function a(){return"undefined"!==typeof i&&"undefined"!==typeof i.versions&&"undefined"!==typeof i.versions.node}function c(){return!s.getDocument()&&!!s.getNavigator()&&"ReactNative"===navigator.product}function u(){return!a()&&!!s.getNavigator()}function d(){return c()?"react-native":a()?"node":u()?"browser":"unknown"}function l(e,t){let n=r.parse(e);return n=Object.assign(Object.assign({},n),t),e=r.stringify(n)}function f(e,t){var n;const i=d(),r={protocol:e,version:t,env:i};return"browser"===i&&(r.host=(null===(n=s.getLocation())||void 0===n?void 0:n.host)||""),r}function E(e){return e.trim().replace(/^\w/,(e=>e.toUpperCase()))}t.isNode=a,t.isReactNative=c,t.isBrowser=u,t.getEnvironment=d,t.appendToQueryString=l,t.getAppMetadata=function(){return o.getWindowMetadata()||void 0},t.getRelayClientMetadata=f,t.formatRelayRpcUrl=function(e,t,n){const i=n.split("?"),r=f(e,t),o=l(i[1]||"",r);return i[0]+"?"+o},t.assertType=function(e,t,n){if(!e[t]||typeof e[t]!==n)throw new Error(`Missing or invalid "${t}" param`)},t.hasOverlap=function(e,t){return e.filter((e=>t.includes(e))).length===e.length},t.mapToObj=function(e){return Object.fromEntries(e.entries())},t.objToMap=function(e){return new Map(Object.entries(e))},t.mapEntries=function(e,t){const n={};return Object.keys(e).forEach((i=>{n[i]=t(e[i])})),n},t.enumify=e=>e,t.capitalizeWord=E,t.capitalize=function(e){return e.split(" ").map((e=>E(e))).join(" ")}},5094:function(e,t,n){"use strict";n.r(t),n.d(t,{ERROR:function(){return ee},ERROR_TYPE:function(){return W},appendToQueryString:function(){return q},assertType:function(){return V},capitalize:function(){return F},capitalizeWord:function(){return B},decrypt:function(){return A},deriveSharedKey:function(){return N},encrypt:function(){return P},enumify:function(){return k},formatInvalidResult:function(){return De},formatRelayRpcUrl:function(){return G},formatUri:function(){return ne},formatValidResult:function(){return be},generateKeyPair:function(){return S},generateRandomBytes32:function(){return m},getAppMetadata:function(){return x},getEnvironment:function(){return H},getRelayClientMetadata:function(){return Y},hasOverlap:function(){return j},isBrowser:function(){return M},isNode:function(){return w},isPairingFailed:function(){return le},isPairingResponded:function(){return de},isPairingRespondedStatus:function(){return ue},isReactNative:function(){return L},isSequenceFailed:function(){return ce},isSequenceResponded:function(){return ae},isSequenceRespondedStatus:function(){return se},isSessionFailed:function(){return he},isSessionResponded:function(){return Ee},isSessionRespondedStatus:function(){return fe},isSignalTypePairing:function(){return re},isSignalTypeUri:function(){return oe},isSubscriptionUpdatedEvent:function(){return pe},isValidAccountId:function(){return Pe},isValidArray:function(){return me},isValidChainId:function(){return Ie},isValidString:function(){return Ne},isValidUrl:function(){return Ae},isValidationInvalid:function(){return Ce},mapEntries:function(){return $},mapToObj:function(){return K},objToMap:function(){return J},parseUri:function(){return ie},sha256:function(){return I},validateBlockchainPermissions:function(){return Te},validateBlockchainState:function(){return Se},validateJsonRpcPermissions:function(){return Oe},validateNotificationPermissions:function(){return ve},validateSessionProposeParams:function(){return ge},validateSessionProposeParamsMetadata:function(){return _e},validateSessionProposeParamsPermissions:function(){return Re},validateSessionRespondParams:function(){return ye}});var i=n(1468);function r(e){return i.getBrowerCrypto().getRandomValues(new Uint8Array(e))}const o="AES-CBC",s="HMAC";async function a(e,t="AES-CBC"){return i.getSubtleCrypto().importKey("raw",e,function(e){return e===o?{length:256,name:o}:{hash:{name:"SHA-256"},name:s}}(t),!0,function(e){return e===o?["encrypt","decrypt"]:["sign","verify"]}(t))}async function c(e,t){const n=i.getSubtleCrypto(),r=await a(e,s),o=await n.sign({length:256,name:s},r,t);return new Uint8Array(o)}function u(e,t,n){return async function(e,t,n){const r=i.getSubtleCrypto(),s=await a(t,o),c=await r.encrypt({iv:e,name:o},s,n);return new Uint8Array(c)}(e,t,n)}function d(e,t,n){return async function(e,t,n){const r=i.getSubtleCrypto(),s=await a(t,o),c=await r.decrypt({iv:e,name:o},s,n);return new Uint8Array(c)}(e,t,n)}var l=n(2102);async function f(e){return await async function(e){const t=i.getSubtleCrypto(),n=await t.digest({name:"SHA-256"},e);return new Uint8Array(n)}(e)}async function E(e){return await async function(e){const t=i.getSubtleCrypto(),n=await t.digest({name:"SHA-512"},e);return new Uint8Array(n)}(e)}var h=n(3087),p=n(7664);function R(e,t){return p.gi(e,t)}function _(e){const t="undefined"!==typeof e?function(e){return{isAvailable:!0,randomBytes:()=>e}}(e):void 0,n=p.Au(t);return{publicKey:n.publicKey,privateKey:n.secretKey}}function g(e){return new Uint8Array(e.slice(0,32))}function y(e){return new Uint8Array(e.slice(32))}async function T(e){const t=await E(e);return{encryptionKey:g(t),macKey:y(t)}}async function O(e,t,n,i=r(16)){const{encryptionKey:o,macKey:s}=await T(t),a=await u(i,o,e),d=(0,h.concatArrays)(i,n,a),l=await async function(e,t){return await c(e,t)}(s,d);return f={iv:i,publicKey:n,ciphertext:a,mac:l},(0,h.concatArrays)(f.iv,f.publicKey,f.mac,f.ciphertext);var f}async function v(e,t){const{iv:n,publicKey:i,mac:r,ciphertext:o}=function(e){const t=e.length;return{iv:e.slice(0,16),publicKey:e.slice(16,48),mac:e.slice(48,80),ciphertext:e.slice(80,t)}}(e),{encryptionKey:s,macKey:a}=await T(t),u=(0,h.concatArrays)(n,i,o),f=await async function(e,t,n){const i=await c(e,t);return(0,l.isConstantTime)(i,n)}(a,u,r);(0,l.assert)(f,"Bad MAC");return await d(n,s,o)}function S(){const e=_();return{privateKey:h.arrayToHex(e.privateKey),publicKey:h.arrayToHex(e.publicKey)}}function m(){return h.arrayToHex(r(32))}function N(e,t){const n=R(h.hexToArray(e),h.hexToArray(t));return h.arrayToHex(n)}async function I(e){const t=await f(h.hexToArray(e));return h.arrayToHex(t)}async function P(e){const t=h.utf8ToArray(e.message),n=h.hexToArray(e.sharedKey),i=h.hexToArray(e.publicKey),r="undefined"!==typeof e.iv?h.hexToArray(e.iv):void 0,o=await O(t,n,i,r);return h.arrayToHex(o)}async function A(e){const t=h.hexToArray(e.encrypted),n=h.hexToArray(e.sharedKey),i=await v(t,n);return h.arrayToUtf8(i)}var C=n(7563),b=n(5755),D=n(2873),U=n(4155);function w(){return"undefined"!==typeof U&&"undefined"!==typeof U.versions&&"undefined"!==typeof U.versions.node}function L(){return!(0,D.getDocument)()&&!!(0,D.getNavigator)()&&"ReactNative"===navigator.product}function M(){return!w()&&!!(0,D.getNavigator)()}function H(){return L()?"react-native":w()?"node":M()?"browser":"unknown"}function q(e,t){let n=C.parse(e);return n=Object.assign(Object.assign({},n),t),e=C.stringify(n)}function x(){return(0,b.getWindowMetadata)()||void 0}function Y(e,t){var n;const i=H(),r={protocol:e,version:t,env:i};return"browser"===i&&(r.host=(null===(n=(0,D.getLocation)())||void 0===n?void 0:n.host)||""),r}function G(e,t,n){const i=n.split("?"),r=Y(e,t),o=q(i[1]||"",r);return i[0]+"?"+o}function V(e,t,n){if(!e[t]||typeof e[t]!==n)throw new Error(`Missing or invalid "${t}" param`)}function j(e,t){return e.filter((e=>t.includes(e))).length===e.length}function K(e){return Object.fromEntries(e.entries())}function J(e){return new Map(Object.entries(e))}function $(e,t){const n={};return Object.keys(e).forEach((i=>{n[i]=t(e[i])})),n}const k=e=>e;function B(e){return e.trim().replace(/^\w/,(e=>e.toUpperCase()))}function F(e){return e.split(" ").map((e=>B(e))).join(" ")}const W=k({GENERIC:"GENERIC",MISSING_OR_INVALID:"MISSING_OR_INVALID",MISSING_RESPONSE:"MISSING_RESPONSE",MISSING_DECRYPT_PARAMS:"MISSING_DECRYPT_PARAMS",INVALID_UPDATE_REQUEST:"INVALID_UPDATE_REQUEST",INVALID_UPGRADE_REQUEST:"INVALID_UPGRADE_REQUEST",RECORD_ALREADY_EXISTS:"RECORD_ALREADY_EXISTS",RESTORE_WILL_OVERRIDE:"RESTORE_WILL_OVERRIDE",NO_MATCHING_ID:"NO_MATCHING_ID",NO_MATCHING_TOPIC:"NO_MATCHING_TOPIC",NO_MATCHING_RESPONSE:"NO_MATCHING_RESPONSE",NO_MATCHING_KEY:"NO_MATCHING_KEY",UNKNOWN_JSONRPC_METHOD:"UNKNOWN_JSONRPC_METHOD",MISMATCHED_TOPIC:"MISMATCHED_TOPIC",MISMATCHED_ACCOUNTS:"MISMATCHED_ACCOUNTS",SETTLED:"SETTLED",NOT_APPROVED:"NOT_APPROVED",PROPOSAL_RESPONDED:"PROPOSAL_RESPONDED",RESPONSE_ACKNOWLEDGED:"RESPONSE_ACKNOWLEDGED",EXPIRED:"EXPIRED",SETTLE_TIMEOUT:"SETTLE_TIMEOUT",JSONRPC_REQUEST_TIMEOUT:"JSONRPC_REQUEST_TIMEOUT",UNAUTHORIZED_TARGET_CHAIN:"UNAUTHORIZED_TARGET_CHAIN",UNAUTHORIZED_JSON_RPC_METHOD:"UNAUTHORIZED_JSON_RPC_METHOD",UNAUTHORIZED_NOTIFICATION_TYPE:"UNAUTHORIZED_NOTIFICATION_TYPE",UNAUTHORIZED_UPDATE_REQUEST:"UNAUTHORIZED_UPDATE_REQUEST",UNAUTHORIZED_UPGRADE_REQUEST:"UNAUTHORIZED_UPGRADE_REQUEST",UNAUTHORIZED_MATCHING_CONTROLLER:"UNAUTHORIZED_MATCHING_CONTROLLER",JSONRPC_REQUEST_METHOD_REJECTED:"JSONRPC_REQUEST_METHOD_REJECTED",JSONRPC_REQUEST_METHOD_UNAUTHORIZED:"JSONRPC_REQUEST_METHOD_UNAUTHORIZED",JSONRPC_REQUEST_METHOD_UNSUPPORTED:"JSONRPC_REQUEST_METHOD_UNSUPPORTED",DISCONNECTED_ALL_CHAINS:"DISCONNECTED_ALL_CHAINS",DISCONNECTED_TARGET_CHAIN:"DISCONNECTED_TARGET_CHAIN",DISAPPROVED_CHAINS:"DISAPPROVED_CHAINS",DISAPPROVED_JSONRPC:"DISAPPROVED_JSONRPC",DISAPPROVED_NOTIFICATION:"DISAPPROVED_NOTIFICATION",UNSUPPORTED_CHAINS:"UNSUPPORTED_CHAINS",UNSUPPORTED_JSONRPC:"UNSUPPORTED_JSONRPC",UNSUPPORTED_NOTIFICATION:"UNSUPPORTED_NOTIFICATION",UNSUPPORTED_SIGNAL:"UNSUPPORTED_SIGNAL",USER_DISCONNECTED:"USER_DISCONNECTED",UNKNOWN:"UNKNOWN"}),Q="Something went wrong",Z="parameter",z="session",X="Ethereum",ee={[W.GENERIC]:{type:W.GENERIC,code:0,stringify:e=>(null===e||void 0===e?void 0:e.message)||Q,format:e=>({code:ee[W.GENERIC].code,message:ee[W.GENERIC].stringify(e)})},[W.MISSING_OR_INVALID]:{type:W.MISSING_OR_INVALID,code:1e3,stringify:e=>`Missing or invalid ${(null===e||void 0===e?void 0:e.name)||Z}`,format:e=>({code:ee[W.MISSING_OR_INVALID].code,message:ee[W.MISSING_OR_INVALID].stringify(e)})},[W.MISSING_RESPONSE]:{type:W.MISSING_RESPONSE,code:1001,stringify:e=>`Response is required for approved ${(null===e||void 0===e?void 0:e.context)||z} proposals`,format:e=>({code:ee[W.MISSING_RESPONSE].code,message:ee[W.MISSING_RESPONSE].stringify(e)})},[W.MISSING_DECRYPT_PARAMS]:{type:W.MISSING_DECRYPT_PARAMS,code:1002,stringify:e=>`Decrypt params required for ${(null===e||void 0===e?void 0:e.context)||z}`,format:e=>({code:ee[W.MISSING_DECRYPT_PARAMS].code,message:ee[W.MISSING_DECRYPT_PARAMS].stringify(e)})},[W.INVALID_UPDATE_REQUEST]:{type:W.INVALID_UPDATE_REQUEST,code:1003,stringify:e=>`Invalid ${(null===e||void 0===e?void 0:e.context)||z} update request`,format:e=>({code:ee[W.INVALID_UPDATE_REQUEST].code,message:ee[W.INVALID_UPDATE_REQUEST].stringify(e)})},[W.INVALID_UPGRADE_REQUEST]:{type:W.INVALID_UPGRADE_REQUEST,code:1004,stringify:e=>`Invalid ${(null===e||void 0===e?void 0:e.context)||z} upgrade request`,format:e=>({code:ee[W.INVALID_UPGRADE_REQUEST].code,message:ee[W.INVALID_UPGRADE_REQUEST].stringify(e)})},[W.RECORD_ALREADY_EXISTS]:{type:W.RECORD_ALREADY_EXISTS,code:1100,stringify:e=>`Record already exists for ${(null===e||void 0===e?void 0:e.context)||z} matching id: ${null===e||void 0===e?void 0:e.id}`,format:e=>({code:ee[W.RECORD_ALREADY_EXISTS].code,message:ee[W.RECORD_ALREADY_EXISTS].stringify(e)})},[W.RESTORE_WILL_OVERRIDE]:{type:W.RESTORE_WILL_OVERRIDE,code:1200,stringify:e=>`Restore will override already set ${(null===e||void 0===e?void 0:e.context)||z}`,format:e=>({code:ee[W.RESTORE_WILL_OVERRIDE].code,message:ee[W.RESTORE_WILL_OVERRIDE].stringify(e)})},[W.NO_MATCHING_ID]:{type:W.NO_MATCHING_ID,code:1300,stringify:e=>`No matching ${(null===e||void 0===e?void 0:e.context)||z} with id: ${null===e||void 0===e?void 0:e.id}`,format:e=>({code:ee[W.NO_MATCHING_ID].code,message:ee[W.NO_MATCHING_ID].stringify(e)})},[W.NO_MATCHING_TOPIC]:{type:W.NO_MATCHING_TOPIC,code:1301,stringify:e=>`No matching ${(null===e||void 0===e?void 0:e.context)||z} with topic: ${null===e||void 0===e?void 0:e.topic}`,format:e=>({code:ee[W.NO_MATCHING_TOPIC].code,message:ee[W.NO_MATCHING_TOPIC].stringify(e)})},[W.NO_MATCHING_RESPONSE]:{type:W.NO_MATCHING_RESPONSE,code:1302,stringify:e=>`No response found in pending ${(null===e||void 0===e?void 0:e.context)||z} proposal`,format:e=>({code:ee[W.NO_MATCHING_RESPONSE].code,message:ee[W.NO_MATCHING_RESPONSE].stringify(e)})},[W.NO_MATCHING_KEY]:{type:W.NO_MATCHING_KEY,code:1303,stringify:e=>`No matching key with tag: ${null===e||void 0===e?void 0:e.tag}`,format:e=>({code:ee[W.NO_MATCHING_KEY].code,message:ee[W.NO_MATCHING_KEY].stringify(e)})},[W.UNKNOWN_JSONRPC_METHOD]:{type:W.UNKNOWN_JSONRPC_METHOD,code:1400,stringify:e=>`Unknown JSON-RPC Method Requested: ${null===e||void 0===e?void 0:e.method}`,format:e=>({code:ee[W.UNKNOWN_JSONRPC_METHOD].code,message:ee[W.UNKNOWN_JSONRPC_METHOD].stringify(e)})},[W.MISMATCHED_TOPIC]:{type:W.MISMATCHED_TOPIC,code:1500,stringify:e=>`Mismatched topic for ${(null===e||void 0===e?void 0:e.context)||z} with id: ${null===e||void 0===e?void 0:e.id}`,format:e=>({code:ee[W.MISMATCHED_TOPIC].code,message:ee[W.MISMATCHED_TOPIC].stringify(e)})},[W.MISMATCHED_ACCOUNTS]:{type:W.MISMATCHED_ACCOUNTS,code:1501,stringify:e=>`Invalid accounts with mismatched chains: ${null===e||void 0===e?void 0:e.mismatched.toString()}`,format:e=>({code:ee[W.MISMATCHED_ACCOUNTS].code,message:ee[W.MISMATCHED_ACCOUNTS].stringify(e)})},[W.SETTLED]:{type:W.SETTLED,code:1600,stringify:e=>`${F((null===e||void 0===e?void 0:e.context)||z)} settled`,format:e=>({code:ee[W.SETTLED].code,message:ee[W.SETTLED].stringify(e)})},[W.NOT_APPROVED]:{type:W.NOT_APPROVED,code:1601,stringify:e=>`${F((null===e||void 0===e?void 0:e.context)||z)} not approved`,format:e=>({code:ee[W.NOT_APPROVED].code,message:ee[W.NOT_APPROVED].stringify(e)})},[W.PROPOSAL_RESPONDED]:{type:W.PROPOSAL_RESPONDED,code:1602,stringify:e=>`${F((null===e||void 0===e?void 0:e.context)||z)} proposal responded`,format:e=>({code:ee[W.PROPOSAL_RESPONDED].code,message:ee[W.PROPOSAL_RESPONDED].stringify(e)})},[W.RESPONSE_ACKNOWLEDGED]:{type:W.RESPONSE_ACKNOWLEDGED,code:1603,stringify:e=>`${F((null===e||void 0===e?void 0:e.context)||z)} response acknowledge`,format:e=>({code:ee[W.RESPONSE_ACKNOWLEDGED].code,message:ee[W.RESPONSE_ACKNOWLEDGED].stringify(e)})},[W.EXPIRED]:{type:W.EXPIRED,code:1603,stringify:e=>`${F((null===e||void 0===e?void 0:e.context)||z)} expired`,format:e=>({code:ee[W.EXPIRED].code,message:ee[W.EXPIRED].stringify(e)})},[W.SETTLE_TIMEOUT]:{type:W.SETTLE_TIMEOUT,code:2e3,stringify:e=>`${F((null===e||void 0===e?void 0:e.context)||z)} failed to settle after ${(null===e||void 0===e?void 0:e.timeout)/1e3} seconds`,format:e=>({code:ee[W.SETTLE_TIMEOUT].code,message:ee[W.SETTLE_TIMEOUT].stringify(e)})},[W.JSONRPC_REQUEST_TIMEOUT]:{type:W.JSONRPC_REQUEST_TIMEOUT,code:2001,stringify:e=>`JSON-RPC Request timeout after ${(null===e||void 0===e?void 0:e.timeout)/1e3} seconds: ${null===e||void 0===e?void 0:e.method}`,format:e=>({code:ee[W.JSONRPC_REQUEST_TIMEOUT].code,message:ee[W.JSONRPC_REQUEST_TIMEOUT].stringify(e)})},[W.UNAUTHORIZED_TARGET_CHAIN]:{type:W.UNAUTHORIZED_TARGET_CHAIN,code:3e3,stringify:e=>`Unauthorized Target ChainId Requested: ${null===e||void 0===e?void 0:e.chainId}`,format:e=>({code:ee[W.UNAUTHORIZED_TARGET_CHAIN].code,message:ee[W.UNAUTHORIZED_TARGET_CHAIN].stringify(e)})},[W.UNAUTHORIZED_JSON_RPC_METHOD]:{type:W.UNAUTHORIZED_JSON_RPC_METHOD,code:3001,stringify:e=>`Unauthorized JSON-RPC Method Requested: ${null===e||void 0===e?void 0:e.method}`,format:e=>({code:ee[W.UNAUTHORIZED_JSON_RPC_METHOD].code,message:ee[W.UNAUTHORIZED_JSON_RPC_METHOD].stringify(e)})},[W.UNAUTHORIZED_NOTIFICATION_TYPE]:{type:W.UNAUTHORIZED_NOTIFICATION_TYPE,code:3002,stringify:e=>`Unauthorized Notification Type Requested: ${null===e||void 0===e?void 0:e.type}`,format:e=>({code:ee[W.UNAUTHORIZED_NOTIFICATION_TYPE].code,message:ee[W.UNAUTHORIZED_NOTIFICATION_TYPE].stringify(e)})},[W.UNAUTHORIZED_UPDATE_REQUEST]:{type:W.UNAUTHORIZED_UPDATE_REQUEST,code:3003,stringify:e=>`Unauthorized ${(null===e||void 0===e?void 0:e.context)||z} update request`,format:e=>({code:ee[W.UNAUTHORIZED_UPDATE_REQUEST].code,message:ee[W.UNAUTHORIZED_UPDATE_REQUEST].stringify(e)})},[W.UNAUTHORIZED_UPGRADE_REQUEST]:{type:W.UNAUTHORIZED_UPGRADE_REQUEST,code:3004,stringify:e=>`Unauthorized ${(null===e||void 0===e?void 0:e.context)||z} upgrade request`,format:e=>({code:ee[W.UNAUTHORIZED_UPGRADE_REQUEST].code,message:ee[W.UNAUTHORIZED_UPGRADE_REQUEST].stringify(e)})},[W.UNAUTHORIZED_MATCHING_CONTROLLER]:{type:W.UNAUTHORIZED_MATCHING_CONTROLLER,code:3005,stringify:e=>`Unauthorized: peer is also ${(null===e||void 0===e?void 0:e.controller)?"":"not "}controller`,format:e=>({code:ee[W.UNAUTHORIZED_MATCHING_CONTROLLER].code,message:ee[W.UNAUTHORIZED_MATCHING_CONTROLLER].stringify(e)})},[W.JSONRPC_REQUEST_METHOD_REJECTED]:{type:W.JSONRPC_REQUEST_METHOD_REJECTED,code:4001,stringify:e=>"User rejected the request.",format:e=>({code:ee[W.JSONRPC_REQUEST_METHOD_REJECTED].code,message:ee[W.JSONRPC_REQUEST_METHOD_REJECTED].stringify(e)})},[W.JSONRPC_REQUEST_METHOD_UNAUTHORIZED]:{type:W.JSONRPC_REQUEST_METHOD_UNAUTHORIZED,code:4100,stringify:e=>"The requested account and/or method has not been authorized by the user.",format:e=>({code:ee[W.JSONRPC_REQUEST_METHOD_UNAUTHORIZED].code,message:ee[W.JSONRPC_REQUEST_METHOD_UNAUTHORIZED].stringify(e)})},[W.JSONRPC_REQUEST_METHOD_UNSUPPORTED]:{type:W.JSONRPC_REQUEST_METHOD_UNSUPPORTED,code:4200,stringify:e=>`The requested method is not supported by this ${(null===e||void 0===e?void 0:e.blockhain)||X} provider.`,format:e=>({code:ee[W.JSONRPC_REQUEST_METHOD_UNSUPPORTED].code,message:ee[W.JSONRPC_REQUEST_METHOD_UNSUPPORTED].stringify(e)})},[W.DISCONNECTED_ALL_CHAINS]:{type:W.DISCONNECTED_ALL_CHAINS,code:4900,stringify:e=>"The provider is disconnected from all chains.",format:e=>({code:ee[W.DISCONNECTED_ALL_CHAINS].code,message:ee[W.DISCONNECTED_ALL_CHAINS].stringify(e)})},[W.DISCONNECTED_TARGET_CHAIN]:{type:W.DISCONNECTED_TARGET_CHAIN,code:4901,stringify:e=>"The provider is disconnected from the specified chain.",format:e=>({code:ee[W.DISCONNECTED_TARGET_CHAIN].code,message:ee[W.DISCONNECTED_TARGET_CHAIN].stringify(e)})},[W.DISAPPROVED_CHAINS]:{type:W.DISAPPROVED_CHAINS,code:5e3,stringify:e=>"User disapproved requested chains",format:e=>({code:ee[W.DISAPPROVED_CHAINS].code,message:ee[W.DISAPPROVED_CHAINS].stringify(e)})},[W.DISAPPROVED_JSONRPC]:{type:W.DISAPPROVED_JSONRPC,code:5001,stringify:e=>"User disapproved requested json-rpc methods",format:e=>({code:ee[W.DISAPPROVED_JSONRPC].code,message:ee[W.DISAPPROVED_JSONRPC].stringify(e)})},[W.DISAPPROVED_NOTIFICATION]:{type:W.DISAPPROVED_NOTIFICATION,code:5002,stringify:e=>"User disapproved requested notification types",format:e=>({code:ee[W.DISAPPROVED_NOTIFICATION].code,message:ee[W.DISAPPROVED_NOTIFICATION].stringify(e)})},[W.UNSUPPORTED_CHAINS]:{type:W.UNSUPPORTED_CHAINS,code:5100,stringify:e=>`Requested chains are not supported: ${null===e||void 0===e?void 0:e.chains.toString()}`,format:e=>({code:ee[W.UNSUPPORTED_CHAINS].code,message:ee[W.UNSUPPORTED_CHAINS].stringify(e)})},[W.UNSUPPORTED_JSONRPC]:{type:W.UNSUPPORTED_JSONRPC,code:5101,stringify:e=>`Requested json-rpc methods are not supported: ${null===e||void 0===e?void 0:e.methods.toString()}`,format:e=>({code:ee[W.UNSUPPORTED_JSONRPC].code,message:ee[W.UNSUPPORTED_JSONRPC].stringify(e)})},[W.UNSUPPORTED_NOTIFICATION]:{type:W.UNSUPPORTED_NOTIFICATION,code:5102,stringify:e=>`Requested notification types are not supported: ${null===e||void 0===e?void 0:e.types.toString()}`,format:e=>({code:ee[W.UNSUPPORTED_NOTIFICATION].code,message:ee[W.UNSUPPORTED_NOTIFICATION].stringify(e)})},[W.UNSUPPORTED_SIGNAL]:{type:W.UNSUPPORTED_SIGNAL,code:5103,stringify:e=>`Proposed ${(null===e||void 0===e?void 0:e.context)||z} signal is unsupported`,format:e=>({code:ee[W.UNSUPPORTED_SIGNAL].code,message:ee[W.UNSUPPORTED_SIGNAL].stringify(e)})},[W.USER_DISCONNECTED]:{type:W.USER_DISCONNECTED,code:5900,stringify:e=>`User disconnected ${(null===e||void 0===e?void 0:e.context)||z}`,format:e=>({code:ee[W.USER_DISCONNECTED].code,message:ee[W.USER_DISCONNECTED].stringify(e)})},[W.UNKNOWN]:{type:W.UNKNOWN,code:9e3,stringify:e=>"Unknown error"+(e?`: ${null===e||void 0===e?void 0:e.toString()}`:""),format:e=>({code:ee[W.UNKNOWN].code,message:ee[W.UNKNOWN].stringify(e)})}};var te=n(1055);function ne(e){return`${e.protocol}:${e.topic}@${e.version}?`+C.stringify({publicKey:e.publicKey,controller:e.controller,relay:(0,te.safeJsonStringify)(e.relay)})}function ie(e){const t=e.indexOf(":"),n=-1!==e.indexOf("?")?e.indexOf("?"):void 0,i=e.substring(0,t),r=e.substring(t+1,n).split("@"),o="undefined"!==typeof n?e.substr(n):"",s=C.parse(o);return{protocol:i,topic:r[0],version:parseInt(r[1],10),publicKey:s.publicKey,controller:"true"===s.controller,relay:(0,te.safeJsonParse)(s.relay)}}function re(e){return"pairing"===e.method}function oe(e){return"uri"===e.method}function se(e){return"responded"===e}function ae(e){return se(e.status)&&"outcome"in e}function ce(e){return"reason"in e}function ue(e){return"responded"===e}function de(e){return ue(e.status)&&"outcome"in e}function le(e){return"reason"in e}function fe(e){return"responded"===e}function Ee(e){return ue(e.status)&&"outcome"in e}function he(e){return"reason"in e}function pe(e){return"update"in e}function Re(e){const t=Te(e.blockchain);if(Ce(t))return t;const n=Oe(e.jsonrpc);if(Ce(n))return n;const i=ve(e.notifications);return Ce(i)?i:{valid:!0}}function _e(e){return Ne(e.name)?Ne(e.description)?"undefined"!==typeof e.url&&Ae(e.url)?"undefined"!==typeof e.icons&&me(e.icons,Ae)?{valid:!0}:De(ee.MISSING_OR_INVALID.format({name:"metadata icons"})):De(ee.MISSING_OR_INVALID.format({name:"metadata url"})):De(ee.MISSING_OR_INVALID.format({name:"metadata description"})):De(ee.MISSING_OR_INVALID.format({name:"metadata name"}))}function ge(e){const t=Re(e.permissions);if(Ce(t))return t;const n=_e(e.metadata);return Ce(n)?n:{valid:!0}}function ye(e){if(e.approved){if("undefined"===typeof e.response)return De(ee.MISSING_RESPONSE.format({context:"session"}));const t=Se(e.response.state,e.proposal.permissions.blockchain);if(Ce(t))return t;const n=_e(e.response.metadata);if(Ce(n))return n}return{valid:!0}}function Te(e){return"undefined"!==typeof e&&"undefined"!==typeof e.chains&&me(e.chains,Ie)?{valid:!0}:De(ee.MISSING_OR_INVALID.format({name:"blockchain permissions"}))}function Oe(e){return"undefined"!==typeof e&&"undefined"!==typeof e.methods&&me(e.methods,Ne)?{valid:!0}:De(ee.MISSING_OR_INVALID.format({name:"jsonrpc permissions"}))}function ve(e){return"undefined"!==typeof e&&"undefined"!==typeof e.types&&me(e.types,Ne)?{valid:!0}:De(ee.MISSING_OR_INVALID.format({name:"notification permissions"}))}function Se(e,t){if("undefined"===typeof t||"undefined"===typeof t.chains||!me(t.chains,Ie))return De(ee.MISSING_OR_INVALID.format({name:"blockchain permissions"}));if("undefined"===typeof e||"undefined"===typeof e.accounts||!me(e.accounts,Pe))return De(ee.MISSING_OR_INVALID.format({name:"state accounts"}));const n=e.accounts.filter((e=>{const[n,i]=e.split(":"),r=`${n}:${i}`;return!t.chains.includes(r)}));return n.length?De(ee.MISMATCHED_ACCOUNTS.format({mismatched:n})):{valid:!0}}function me(e,t){if(Array.isArray(e)){if("undefined"!==typeof t&&e.length){return e.filter(t).length===e.length}return!0}return!1}function Ne(e){return"string"===typeof e&&!!e.trim()}function Ie(e){if(Ne(e)&&e.includes(":")){return 2===e.split(":").length}return!1}function Pe(e){if(Ne(e)&&e.includes(":")){const t=e.split(":");if(3===t.length){const e=t[0]+":"+t[1];return!!t[2]&&Ie(e)}}return!1}function Ae(e){if(Ne(e))try{return"undefined"!==typeof new URL(e)}catch(t){return!1}return!1}function Ce(e){return"valid"in e&&!1===e.valid&&"error"in e&&"number"===typeof e.error.code&&"string"===typeof e.error.message}function be(){return{valid:!0}}function De(e){return{valid:!1,error:e}}},2873:function(e,t){"use strict";function n(e){let t;return"undefined"!==typeof window&&"undefined"!==typeof window[e]&&(t=window[e]),t}function i(e){const t=n(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStorage=t.getLocalStorageOrThrow=t.getCrypto=t.getCryptoOrThrow=t.getLocation=t.getLocationOrThrow=t.getNavigator=t.getNavigatorOrThrow=t.getDocument=t.getDocumentOrThrow=t.getFromWindowOrThrow=t.getFromWindow=void 0,t.getFromWindow=n,t.getFromWindowOrThrow=i,t.getDocumentOrThrow=function(){return i("document")},t.getDocument=function(){return n("document")},t.getNavigatorOrThrow=function(){return i("navigator")},t.getNavigator=function(){return n("navigator")},t.getLocationOrThrow=function(){return i("location")},t.getLocation=function(){return n("location")},t.getCryptoOrThrow=function(){return i("crypto")},t.getCrypto=function(){return n("crypto")},t.getLocalStorageOrThrow=function(){return i("localStorage")},t.getLocalStorage=function(){return n("localStorage")}},5755:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWindowMetadata=void 0;const i=n(2873);t.getWindowMetadata=function(){let e,t;try{e=i.getDocumentOrThrow(),t=i.getLocationOrThrow()}catch(o){return null}function n(...t){const n=e.getElementsByTagName("meta");for(let e=0;e<n.length;e++){const i=n[e],r=["itemprop","property","name"].map((e=>i.getAttribute(e))).filter((e=>!!e&&t.includes(e)));if(r.length&&r){const e=i.getAttribute("content");if(e)return e}}return""}const r=function(){let t=n("name","og:site_name","og:title","twitter:title");return t||(t=e.title),t}();return{description:n("description","og:description","twitter:description","keywords"),url:t.origin,icons:function(){const n=e.getElementsByTagName("link"),i=[];for(let e=0;e<n.length;e++){const r=n[e],o=r.getAttribute("rel");if(o&&o.toLowerCase().indexOf("icon")>-1){const e=r.getAttribute("href");if(e)if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let n=t.protocol+"//"+t.host;if(0===e.indexOf("/"))n+=e;else{const i=t.pathname.split("/");i.pop();n+=i.join("/")+"/"+e}i.push(n)}else if(0===e.indexOf("//")){const n=t.protocol+e;i.push(n)}else i.push(e)}}return i}(),name:r}}},4020:function(e){"use strict";var t="%[a-f0-9]{2}",n=new RegExp(t,"gi"),i=new RegExp("("+t+")+","gi");function r(e,t){try{return decodeURIComponent(e.join(""))}catch(o){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),i=e.slice(t);return Array.prototype.concat.call([],r(n),r(i))}function o(e){try{return decodeURIComponent(e)}catch(o){for(var t=e.match(n),i=1;i<t.length;i++)t=(e=r(t,i).join("")).match(n);return e}}e.exports=function(e){if("string"!==typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var n={"%FE%FF":"\ufffd\ufffd","%FF%FE":"\ufffd\ufffd"},r=i.exec(e);r;){try{n[r[0]]=decodeURIComponent(r[0])}catch(t){var s=o(r[0]);s!==r[0]&&(n[r[0]]=s)}r=i.exec(e)}n["%C2"]="\ufffd";for(var a=Object.keys(n),c=0;c<a.length;c++){var u=a[c];e=e.replace(new RegExp(u,"g"),n[u])}return e}(e)}}},2806:function(e){"use strict";e.exports=function(e,t){for(var n={},i=Object.keys(e),r=Array.isArray(t),o=0;o<i.length;o++){var s=i[o],a=e[s];(r?-1!==t.indexOf(s):t(s,a,e))&&(n[s]=a)}return n}},4501:function(e){e.exports=i,i.strict=r,i.loose=o;var t=Object.prototype.toString,n={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function i(e){return r(e)||o(e)}function r(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function o(e){return n[t.call(e)]}},6939:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IKeyValueStorage=class{}},3534:function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(3681)),s=n(3954),a=n(596);class c{constructor(){this.localStorage=o.default}getKeys(){return i(this,void 0,void 0,(function*(){return Object.keys(this.localStorage)}))}getEntries(){return i(this,void 0,void 0,(function*(){return Object.entries(this.localStorage).map(a.parseEntry)}))}getItem(e){return i(this,void 0,void 0,(function*(){const t=this.localStorage.getItem(e);if(null!==t)return s.safeJsonParse(t)}))}setItem(e,t){return i(this,void 0,void 0,(function*(){this.localStorage.setItem(e,s.safeJsonStringify(t))}))}removeItem(e){return i(this,void 0,void 0,(function*(){this.localStorage.removeItem(e)}))}}t.KeyValueStorage=c,t.default=c},596:function(e,t,n){"use strict";function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n(1327)),i(n(78))},1327:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(6939);t.IKeyValueStorage=i.IKeyValueStorage},78:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(3954);function r(e){return t.REACT_NATIVE_REQUIRED_OPTION in e}function o(e){return t.NODE_JS_REQUIRED_OPTION in e}t.REACT_NATIVE_REQUIRED_OPTION="asyncStorage",t.isReactNativeOptions=r,t.getReactNativeOptions=function(e){if("undefined"===typeof e||!r(e))throw new Error(`Missing ${t.REACT_NATIVE_REQUIRED_OPTION} option required for React-Native`);return e},t.NODE_JS_REQUIRED_OPTION="database",t.isNodeJSOptions=o,t.getNodeJSOptions=function(e){if("undefined"===typeof e||!o(e))throw new Error(`Missing ${t.NODE_JS_REQUIRED_OPTION} option required for NodeJS`);return e},t.parseEntry=function(e){return[e[0],i.safeJsonParse(e[1])]}},3681:function(e,t,n){!function(){"use strict";var t;function i(){}(t=i).prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},t.prototype.setItem=function(e,t){this[e]=String(t)},t.prototype.removeItem=function(e){delete this[e]},t.prototype.clear=function(){var e=this;Object.keys(e).forEach((function(t){e[t]=void 0,delete e[t]}))},t.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},t.prototype.__defineGetter__("length",(function(){return Object.keys(this).length})),n.g.localStorage?e.exports=localStorage:e.exports=new i}()},5571:function(e,t,n){"use strict";const i=n(5346);e.exports=s;const r=function(){function e(e){return"undefined"!==typeof e&&e}try{return"undefined"!==typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},o={mapHttpRequest:h,mapHttpResponse:h,wrapRequestSerializer:p,wrapResponseSerializer:p,wrapErrorSerializer:p,req:h,res:h,err:function(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const n in e)void 0===t[n]&&(t[n]=e[n]);return t}};function s(e){(e=e||{}).browser=e.browser||{};const t=e.browser.transmit;if(t&&"function"!==typeof t.send)throw Error("pino: transmit option must have a send function");const n=e.browser.write||r;e.browser.write&&(e.browser.asObject=!0);const i=e.serializers||{},o=function(e,t){if(Array.isArray(e))return e.filter((function(e){return"!stdSerializers.err"!==e}));return!0===e&&Object.keys(t)}(e.browser.serialize,i);let c=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(c=!1);"function"===typeof n&&(n.error=n.fatal=n.warn=n.info=n.debug=n.trace=n),!1===e.enabled&&(e.level="silent");const l=e.level||"info",h=Object.create(n);h.log||(h.log=R),Object.defineProperty(h,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(h,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,a(p,h,"error","log"),a(p,h,"fatal","error"),a(p,h,"warn","error"),a(p,h,"info","log"),a(p,h,"debug","log"),a(p,h,"trace","log")}});const p={transmit:t,serialize:o,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:E(e)};return h.levels=s.levels,h.level=l,h.setMaxListeners=h.getMaxListeners=h.emit=h.addListener=h.on=h.prependListener=h.once=h.prependOnceListener=h.removeListener=h.removeAllListeners=h.listeners=h.listenerCount=h.eventNames=h.write=h.flush=R,h.serializers=i,h._serialize=o,h._stdErrSerialize=c,h.child=function(n,r){if(!n)throw new Error("missing bindings for child Pino");r=r||{},o&&n.serializers&&(r.serializers=n.serializers);const s=r.serializers;if(o&&s){var a=Object.assign({},i,s),c=!0===e.browser.serialize?Object.keys(a):o;delete n.serializers,u([n],c,a,this._stdErrSerialize)}function l(e){this._childLevel=1+(0|e._childLevel),this.error=d(e,n,"error"),this.fatal=d(e,n,"fatal"),this.warn=d(e,n,"warn"),this.info=d(e,n,"info"),this.debug=d(e,n,"debug"),this.trace=d(e,n,"trace"),a&&(this.serializers=a,this._serialize=c),t&&(this._logEvent=f([].concat(e._logEvent.bindings,n)))}return l.prototype=this,new l(this)},t&&(h._logEvent=f()),h}function a(e,t,n,i){const o=Object.getPrototypeOf(t);t[n]=t.levelVal>t.levels.values[n]?R:o[n]?o[n]:r[n]||r[i]||R,function(e,t,n){if(!e.transmit&&t[n]===R)return;t[n]=(i=t[n],function(){const o=e.timestamp(),a=new Array(arguments.length),d=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var f=0;f<a.length;f++)a[f]=arguments[f];if(e.serialize&&!e.asObject&&u(a,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?i.call(d,c(this,n,a,o)):i.apply(d,a),e.transmit){const i=e.transmit.level||t.level,r=s.levels.values[i],c=s.levels.values[n];if(c<r)return;l(this,{ts:o,methodLevel:n,methodValue:c,transmitLevel:i,transmitValue:s.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},a)}});var i}(e,t,n)}function c(e,t,n,r){e._serialize&&u(n,e._serialize,e.serializers,e._stdErrSerialize);const o=n.slice();let a=o[0];const c={};r&&(c.time=r),c.level=s.levels.values[t];let d=1+(0|e._childLevel);if(d<1&&(d=1),null!==a&&"object"===typeof a){for(;d--&&"object"===typeof o[0];)Object.assign(c,o.shift());a=o.length?i(o.shift(),o):void 0}else"string"===typeof a&&(a=i(o.shift(),o));return void 0!==a&&(c.msg=a),c}function u(e,t,n,i){for(const r in e)if(i&&e[r]instanceof Error)e[r]=s.stdSerializers.err(e[r]);else if("object"===typeof e[r]&&!Array.isArray(e[r]))for(const i in e[r])t&&t.indexOf(i)>-1&&i in n&&(e[r][i]=n[i](e[r][i]))}function d(e,t,n){return function(){const i=new Array(1+arguments.length);i[0]=t;for(var r=1;r<i.length;r++)i[r]=arguments[r-1];return e[n].apply(this,i)}}function l(e,t,n){const i=t.send,r=t.ts,o=t.methodLevel,s=t.methodValue,a=t.val,c=e._logEvent.bindings;u(n,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=r,e._logEvent.messages=n.filter((function(e){return-1===c.indexOf(e)})),e._logEvent.level.label=o,e._logEvent.level.value=s,i(o,e._logEvent,a),e._logEvent=f(c)}function f(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function E(e){return"function"===typeof e.timestamp?e.timestamp:!1===e.timestamp?_:g}function h(){return{}}function p(e){return e}function R(){}function _(){return!1}function g(){return Date.now()}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=o,s.stdTimeFunctions=Object.assign({},{nullTime:_,epochTime:g,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}})},7563:function(e,t,n){"use strict";const i=n(610),r=n(4020),o=n(500),s=n(2806);function a(e){if("string"!==typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function c(e,t){return t.encode?t.strict?i(e):encodeURIComponent(e):e}function u(e,t){return t.decode?r(e):e}function d(e){return Array.isArray(e)?e.sort():"object"===typeof e?d(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function l(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function f(e){const t=(e=l(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function E(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"===typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function h(e,t){a((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,i)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),i[e][t[1]]=n):i[e]=n};case"bracket":return(e,n,i)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==i[e]?i[e]=[].concat(i[e],n):i[e]=[n]:i[e]=n};case"comma":case"separator":return(t,n,i)=>{const r="string"===typeof n&&n.includes(e.arrayFormatSeparator),o="string"===typeof n&&!r&&u(n,e).includes(e.arrayFormatSeparator);n=o?u(n,e):n;const s=r||o?n.split(e.arrayFormatSeparator).map((t=>u(t,e))):null===n?n:u(n,e);i[t]=s};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),i=Object.create(null);if("string"!==typeof e)return i;if(!(e=e.trim().replace(/^[?#&]/,"")))return i;for(const r of e.split("&")){if(""===r)continue;let[e,s]=o(t.decode?r.replace(/\+/g," "):r,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:u(s,t),n(u(e,t),s,i)}for(const r of Object.keys(i)){const e=i[r];if("object"===typeof e&&null!==e)for(const n of Object.keys(e))e[n]=E(e[n],t);else i[r]=E(e,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce(((e,t)=>{const n=i[t];return Boolean(n)&&"object"===typeof n&&!Array.isArray(n)?e[t]=d(n):e[t]=n,e}),Object.create(null))}t.extract=f,t.parse=h,t.stringify=(e,t)=>{if(!e)return"";a((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>{return t.skipNull&&(null===(i=e[n])||void 0===i)||t.skipEmptyString&&""===e[n];var i},i=function(e){switch(e.arrayFormat){case"index":return t=>(n,i)=>{const r=n.length;return void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[c(t,e),"[",r,"]"].join("")]:[...n,[c(t,e),"[",c(r,e),"]=",c(i,e)].join("")]};case"bracket":return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,[c(t,e),"[]"].join("")]:[...n,[c(t,e),"[]=",c(i,e)].join("")];case"comma":case"separator":return t=>(n,i)=>null===i||void 0===i||0===i.length?n:0===n.length?[[c(t,e),"=",c(i,e)].join("")]:[[n,c(i,e)].join(e.arrayFormatSeparator)];default:return t=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:null===i?[...n,c(t,e)]:[...n,[c(t,e),"=",c(i,e)].join("")]}}(t),r={};for(const s of Object.keys(e))n(s)||(r[s]=e[s]);const o=Object.keys(r);return!1!==t.sort&&o.sort(t.sort),o.map((n=>{const r=e[n];return void 0===r?"":null===r?c(n,t):Array.isArray(r)?r.reduce(i(n),[]).join("&"):c(n,t)+"="+c(r,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=o(e,"#");return Object.assign({url:n.split("?")[0]||"",query:h(f(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:u(i,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const i=l(e.url).split("?")[0]||"",r=t.extract(e.url),o=t.parse(r,{sort:!1}),s=Object.assign(o,e.query);let a=t.stringify(s,n);a&&(a=`?${a}`);let u=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(u=`#${c(e.fragmentIdentifier,n)}`),`${i}${a}${u}`},t.pick=(e,n,i)=>{i=Object.assign({parseFragmentIdentifier:!0},i);const{url:r,query:o,fragmentIdentifier:a}=t.parseUrl(e,i);return t.stringifyUrl({url:r,query:s(o,n),fragmentIdentifier:a},i)},t.exclude=(e,n,i)=>{const r=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return t.pick(e,r,i)}},5346:function(e){"use strict";function t(e){try{return JSON.stringify(e)}catch(t){return'"[Circular]"'}}e.exports=function(e,n,i){var r=i&&i.stringify||t;if("object"===typeof e&&null!==e){var o=n.length+1;if(1===o)return e;var s=new Array(o);s[0]=r(e);for(var a=1;a<o;a++)s[a]=r(n[a]);return s.join(" ")}if("string"!==typeof e)return e;var c=n.length;if(0===c)return e;for(var u="",d=0,l=-1,f=e&&e.length||0,E=0;E<f;){if(37===e.charCodeAt(E)&&E+1<f){switch(l=l>-1?l:0,e.charCodeAt(E+1)){case 100:case 102:if(d>=c)break;if(null==n[d])break;l<E&&(u+=e.slice(l,E)),u+=Number(n[d]),l=E+2,E++;break;case 105:if(d>=c)break;if(null==n[d])break;l<E&&(u+=e.slice(l,E)),u+=Math.floor(Number(n[d])),l=E+2,E++;break;case 79:case 111:case 106:if(d>=c)break;if(void 0===n[d])break;l<E&&(u+=e.slice(l,E));var h=typeof n[d];if("string"===h){u+="'"+n[d]+"'",l=E+2,E++;break}if("function"===h){u+=n[d].name||"<anonymous>",l=E+2,E++;break}u+=r(n[d]),l=E+2,E++;break;case 115:if(d>=c)break;l<E&&(u+=e.slice(l,E)),u+=String(n[d]),l=E+2,E++;break;case 37:l<E&&(u+=e.slice(l,E)),u+="%",l=E+2,E++,d--}++d}++E}if(-1===l)return e;l<f&&(u+=e.slice(l));return u}},9353:function(e,t,n){e.exports=n(1846)},1846:function(e,t,n){var i=n(1960);t.operation=function(e){var n=t.timeouts(e);return new i(n,{forever:e&&(e.forever||e.retries===1/0),unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],r=0;r<t.retries;r++)i.push(this.createTimeout(r,t));return e&&e.forever&&!i.length&&i.push(this.createTimeout(r,t)),i.sort((function(e,t){return e-t})),i},t.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,i=Math.round(n*Math.max(t.minTimeout,1)*Math.pow(t.factor,e));return i=Math.min(i,t.maxTimeout)},t.wrap=function(e,n,i){if(n instanceof Array&&(i=n,n=null),!i)for(var r in i=[],e)"function"===typeof e[r]&&i.push(r);for(var o=0;o<i.length;o++){var s=i[o],a=e[s];e[s]=function(i){var r=t.operation(n),o=Array.prototype.slice.call(arguments,1),s=o.pop();o.push((function(e){r.retry(e)||(e&&(arguments[0]=r.mainError()),s.apply(this,arguments))})),r.attempt((function(){i.apply(e,o)}))}.bind(e,a),e[s].options=n}}},1960:function(e){function t(e,t){"boolean"===typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=t,t.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},t.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},t.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1)}var i=this;return this._timer=setTimeout((function(){i._attempts++,i._operationTimeoutCb&&(i._timeout=setTimeout((function(){i._operationTimeoutCb(i._attempts)}),i._operationTimeout),i._options.unref&&i._timeout.unref()),i._fn(i._attempts)}),n),this._options.unref&&this._timer.unref(),!0},t.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},t.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},t.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},t.prototype.start=t.prototype.try,t.prototype.errors=function(){return this._errors},t.prototype.attempts=function(){return this._attempts},t.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,i=0;i<this._errors.length;i++){var r=this._errors[i],o=r.message,s=(e[o]||0)+1;e[o]=s,s>=n&&(t=r,n=s)}return t}},3954:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeJsonParse=function(e){if("string"!==typeof e)throw new Error("Cannot safe json parse value of type "+typeof e);try{return JSON.parse(e)}catch(t){return e}},t.safeJsonStringify=function(e){return"string"===typeof e?e:JSON.stringify(e,((e,t)=>"undefined"===typeof t?null:t))}},500:function(e){"use strict";e.exports=(e,t)=>{if("string"!==typeof e||"string"!==typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},610:function(e){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},655:function(e,t,n){"use strict";n.r(t),n.d(t,{__extends:function(){return r},__assign:function(){return o},__rest:function(){return s},__decorate:function(){return a},__param:function(){return c},__metadata:function(){return u},__awaiter:function(){return d},__generator:function(){return l},__createBinding:function(){return f},__exportStar:function(){return E},__values:function(){return h},__read:function(){return p},__spread:function(){return R},__spreadArrays:function(){return _},__await:function(){return g},__asyncGenerator:function(){return y},__asyncDelegator:function(){return T},__asyncValues:function(){return O},__makeTemplateObject:function(){return v},__importStar:function(){return S},__importDefault:function(){return m},__classPrivateFieldGet:function(){return N},__classPrivateFieldSet:function(){return I}});var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function r(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function s(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function a(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}function c(e,t){return function(n,i){t(n,i,e)}}function u(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function l(e,t){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(a){o=[6,a],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function f(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}function E(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])}function h(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function p(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s}function R(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}function _(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function g(e){return this instanceof g?(this.v=e,this):new g(e)}function y(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){o.push([e,t,n,i])>1||a(e,t)}))})}function a(e,t){try{(n=r[e](t)).value instanceof g?Promise.resolve(n.value.v).then(c,u):d(o[0][2],n)}catch(i){d(o[0][3],i)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function d(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function T(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,r){t[i]=e[i]?function(t){return(n=!n)?{value:g(e[i](t)),done:"return"===i}:r?r(t):t}:r}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=h(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){(function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)})(i,r,(t=e[n](t)).done,t.value)}))}}}function v(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}function N(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function I(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}},5054:function(e,t,n){var i=n(8764).Buffer,r=n(4501).strict;e.exports=function(e){if(r(e)){var t=i.from(e.buffer);return e.byteLength!==e.buffer.byteLength&&(t=t.slice(e.byteOffset,e.byteOffset+e.byteLength)),t}return i.from(e)}},6586:function(e,t,n){"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}n.d(t,{Z:function(){return i}})},318:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var i=n(6988);function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(c){a=!0,r=c}finally{try{s||null==n.return||n.return()}finally{if(a)throw r}}return o}}(e,t)||(0,i.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},6988:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var i=n(6586);function r(e,t){if(e){if("string"===typeof e)return(0,i.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,i.Z)(e,t):void 0}}},6209:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var i=n(9353);const r=new Set(["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"]);class o extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,({message:e}=e)):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}async function s(e,t){return new Promise(((n,s)=>{t={onFailedAttempt:()=>{},retries:10,...t};const a=i.operation(t);a.attempt((async i=>{try{n(await e(i))}catch(u){if(!(u instanceof Error))return void s(new TypeError(`Non-error was thrown: "${u}". You should only throw errors.`));if(u instanceof o)a.stop(),s(u.originalError);else if(u instanceof TypeError&&(c=u.message,!r.has(c)))a.stop(),s(u);else{((e,t,n)=>{const i=n.retries-(t-1);e.attemptNumber=t,e.retriesLeft=i})(u,i,t);try{await t.onFailedAttempt(u)}catch(u){return void s(u)}a.retry(u)||s(a.mainError())}}var c}))}))}}}]);